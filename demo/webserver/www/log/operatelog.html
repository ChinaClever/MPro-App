<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>PDU</title>
<link rel="stylesheet" href="../js/bootstrap/css/bootstrap.min.css" />	
<link rel="stylesheet" href="../css/font-awesome.min.css">
<link rel="stylesheet" href="../css/style.css" />
<script type="text/javascript" src="../js/jquery-1.8.3.min.js"></script>
<style type="text/css">
.panel-default{
            border: none;
            border-radius: 0px;
            margin-bottom: 0px;
            box-shadow: none;
            -webkit-box-shadow: none;
}

.panel-default > .panel-heading{
	color: #222;
	font-size:13px;
	background-color: #fff;
	border-color: #e6e6e6;
	padding: 10px 12px;
}

body{ 
	
	background: #fafafa;
}

tr{
	height:28px;
}
</style>

<script>
var flag;
var pg;
$(document).ready(function () {
	$.ajax({
			dataType:"text",
			url:"/npmslavelist",
			cache:false,
			success:function(sta)
			{
				var gv = new Array();
				gv=sta.split("?");
				flag = parseInt(gv[0]);
				LangFun();
	
				pg =  document.getElementById("pg").value;
				if(pg=="")
				{
					pg = "1";
					document.getElementById("pg").value=pg;
				}
				loadpage(pg);
			}
		});
	//setInterval("loadpage(pg);",2000);
});

function mov(obj)
{
	obj.style.background="#f9fae8";
}

function movout(obj)
{
	var index=obj.id.replace("tr","");
	if(parseInt(index)%2!=0)
		obj.style.background="#f0f0f0";
	else
		obj.style.background="#ffffff";
}

function LangFun()
{
	var lang_1 = ["Operation Log", "操作日志", "Journal des opérations", "Журнал операций", "Registro de operaciones", "سجل العملية"];
	var lang_2 = ["No.", "序号", "Numéro de série", "Серийный номер", "Número de serie", "الرقم التسلسلي"];
	var lang_3 = ["Time", "时间", "Temps", "время", "Tiempo", "وقت"];
	var lang_4 = ["User name", "用户名称", "Nom de l 'utilisateur", "Имя пользователя", "Nombre de usuario", "اسم المستخدم"];
	var lang_5 = ["Operation type", "操作类型", "Type d 'opération", "Тип операции", "Tipo de operación", "نوع العملية"];
	var lang_6 = ["Description", "详细描述", "Descriptions", "Подробное описание", "Descripción detallada", "وصف مفصل"];
	var lang_7 = ["Log size：", "日志大小：", "Taille du Journal", "Размер журнала", "Tamaño de registro", "حجم السجل"];
	var lang_8 = ["Page", "页", "Page", "страница", "Pagina", "صفحة"];
	var lang_9 = ["to", "至", "to", "к", "A", "إلى"];
	var lang_10 = ["Go", "前往", "Go", "Перейти к", "Ir a", "اذهب الى"];
	var lang_11 = ["Previous page", "前一页", "Previous", "Предыдущая страница", "Página anterior", "الصفحة السابقة"];
	var lang_12 = ["Next page", "后一页", "Next", "Следующая страница", "Página siguiente", "الصفحة التالية"];
	var lang_13 = ["Delete log", "删除日志", "Delete", "Удалить журнал", "Eliminar registro", "حذف السجل"];
	var lang_14 = ["Export log", "导出", "Export", "экспорт", "Exportar", "تصدير"];
	
	document.getElementById("lang_1") .innerHTML = lang_1[flag];
	document.getElementById("lang_2") .innerHTML = lang_2[flag];
	document.getElementById("lang_3") .innerHTML = lang_3[flag];
	document.getElementById("lang_4") .innerHTML = lang_4[flag];
	document.getElementById("lang_5") .innerHTML = lang_5[flag];
	document.getElementById("lang_6") .innerHTML = lang_6[flag];
	document.getElementById("lang_7") .innerHTML = lang_7[flag];
	document.getElementById("lang_8") .innerHTML = lang_8[flag];
	document.getElementById("lang_9") .innerHTML = lang_9[flag];
	document.getElementById("lang_10").value = lang_10[flag];
	document.getElementById("lang_11").value = lang_11[flag];
	document.getElementById("lang_12").value = lang_12[flag];
	document.getElementById("lang_13").value = lang_13[flag];
	document.getElementById("lang_14").value = lang_14[flag];
}

function gotopage()
{
	var pg =  document.getElementById("pg").value;
	if(pg=="")
	{
		pg = "1";
		document.getElementById("pg").value=pg;
	}
	loadpage(pg);
}
function front()
{
	var pg =  document.getElementById("pg").value;
	if(pg=="")
	{
		pg = "1";
		document.getElementById("pg").value=pg;
	}
	var page = parseInt(pg)-1;
	if(page<1)
	{
		return;
	}
	document.getElementById("pg").value=page;
	loadpage(page);
}
function next()
{
	var pg =  document.getElementById("pg").value;
	if(pg=="")
	{
		pg = "1";
		document.getElementById("pg").value=pg;
	}
	var page = parseInt(pg)+1;
	document.getElementById("pg").value=page;
	loadpage(page);
}

function loadpage(pg)
{	
	var usr_login_1 = ["User Login", "用户登录", "Conditionnalité", "пользователь", "Acceso del usuario", "تسجيل دخول المستخدم"];
	var usr_login_2 = ["Login Success.", "登录成功.", "Travail de connexion", "регистрация прошла успешно", "Acceso concedido.", "تسجيل الدخول الناجح"];
	
	var dev_setup_1 = ["Device configuration", "设备设置", "configuration", "Настройки устройства", "Configuración del dispositivo", "إعدادات الجهاز"];
	var dev_setup_2 = ["The Master/Slave property was changed.", "主副机模式设置发生了变化", "Master/Slave Attributs modifiés", "Master/Slave Настройки режима изменились", "Master/Slave El patrón ha cambiado.", "تم تغيير إعدادات الوضع"];
	var dev_setup_3 = ["The Master/Slave property was changed.", "模式设置发生了变化", "Master/Slave Attributs modifiés", "Настройки режима изменились", "El patrón ha cambiado.", "تم تغيير إعدادات الوضع"];
	var dev_setup_4 = ["(Device name)Device output group was changed.", "(设备名称)设备输出位分组已经发生改变.", "(nom du périphérique) Le paquet de sortie du périphérique a été modifié", "(Название устройства) подгруппа разрядов вывода оборудования изменена", "(nombre del equipo) La célula de salida del equipo ha cambiado.", "(اسم الجهاز) تم تغيير تجميع بت إخراج الجهاز"];
	var dev_setup_5 = ["(Device name->Output unit)value was changed.", "(设备名称->输出单元)参数已经发生改变.", "(nom du périphérique->Unité de sortie) Les paramètres ont changé.", "(Название устройства - > выходной элемент) параметр изменён", "(nombre del dispositivo - > unidad de salida)", "(اسم الجهاز -> وحدة الإخراج) تغيرت المعلمات"];
	var dev_setup_6 = ["(Device name)Device environment control value was changed.", "(设备名称)设备环控设置参数已经发生改变.", "Les paramètres de commande d 'anneau d' équipement ont changé", "Название устройства) Параметры устройства", "(nombre del equipo) los parámetros de la configuración de control del dispositivo han cambiado", "(اسم الجهاز) تغيرت معلمات إعداد التحكم في بيئة الجهاز"];
	var dev_setup_7 = ["(Device name->Output name)electric energy metering is reset.", "(设备名称->单元名称)电能计量复位.", "Remise à zéro de la mesure de l 'énergie électrique", "(Название устройства - > название единицы)", "(nombre del equipo - > nombre de la unidad)", "(اسم الجهاز -> اسم الوحدة) إعادة تعيين عداد الطاقة"];
	var dev_setup_8 = ["(Device name)Overrun power setting value was changed.", "(设备名称)设备输出单元超限断电已经发生改变.", "Les coupures de courant ont changé dans l'unité de sortie.", "(Название устройства) отключение блока вывода оборудования", "La unidad de salida del dispositivo ha cambiado el apagón.", "(اسم الجهاز) تم تغيير تجاوز وحدة إخراج الجهاز"];
	var dev_setup_9 = ["(Device name)Timing switch setting.", "(设备名称)设备输出单元定时开关已经发生改变.", "Le commutateur de synchronisation de l 'unité de sortie du dispositif a changé.", "(Название устройства) часовой выключатель блока вывода оборудования изменился", "El interruptor de salida del dispositivo ha cambiado.", "(اسم الجهاز) تم تغيير مفتاح توقيت وحدة إخراج الجهاز"];
	var dev_setup_10 = ["(Device name)Device outlet ping function was changed.", "(设备名称)设备输出单元ping功能已经发生改变.", "La fonction Ping de l 'unité de sortie a changé.", "(Название устройства) изменена функция устройства ping", "Unidad de salida del dispositivo la función Ping ha cambiado", "(اسم الجهاز) تم تغيير وظيفة ping لوحدة إخراج الجهاز"];
	var dev_setup_11 = ["Control switch", "控制开关", "Interrupteur de commande", "контрольный выключатель", "Interruptor de control", "مفتاح التحكم"];
	var dev_setup_12 = ["through", "通过", "Passer", "проход", "Aprobación", "بواسطة"];
	var dev_setup_13 = ["via", "对", "Passer", "следовать", "Sí", "بواسطة"];
	var dev_setup_14 = ["(Device name->Output name)implementation of the", "(设备名称->单元名称)执行的", "Mise en oeuvre (nom de l 'équipement - > Nom de sortie)", "(Название устройства - > название ячейки)", "(nombre del dispositivo - > nombre de la unidad)", "(اسم الجهاز -> اسم الوحدة) تنفيذها"];
	var dev_setup_15 = ["order.", "命令.", "Ordre", "команда", "Ordenar", "طلب"];	
	
	var net_safe_1 = ["Network Safety", "网络安全", "Sécurité de réseau", "сетевая безопасность", "Seguridad de red", "أمن الشبكة"];
	var net_safe_2 = ["IPv4 configuration was successfully modified.", "IPv4网络信息已经成功的修改.", "IPv4 information sur le réseau", "Информация о сети IPv4 была изменена", "La información de la red IPv4 ha sido modificada satisfactoriamente.", "تم تعديل معلومات شبكة IPv4 بنجاح"];
	var net_safe_3 = ["IPv6 configuration was successfully modified.", "IPv6网络信息已经成功的修改.", "IPv6 information sur le réseau", "Информация о сети IPv6 была изменена", "La información de la red IPv6 ha sido modificada con éxito.", "تم تعديل معلومات شبكة IPv6 بنجاح"];
	var net_safe_4 = ["WIFI connection was changed.", "wifi连接设置已经成功的修改.", "Modification des paramètres de connexion wifi", "параметры подключения Wifi были изменены", "Cambios exitosos en la configuración de la conexión wifi", "تم تعديل إعدادات اتصال WiFi بنجاح"];
	var net_safe_5 = ["WIFI configuration was changed.", "wifi网络设置已经成功的修改.", "Modification des paramètres de connexion wifi", "Параметры сети wifi были изменены", "Cambios exitosos en la configuración de la conexión wifi", "تم تعديل إعدادات شبكة Wifi بنجاح"];
	var net_safe_6 = ["WIFI configuration was changed.", "wifi网络设置已经成功的修改.", "Modification des paramètres de connexion wifi", "Параметры сети wifi были изменены", "Cambios exitosos en la configuración de la conexión wifi", "تم تعديل إعدادات شبكة Wifi بنجاح"];
	var net_safe_7 = ["HTTP configuration was changed.", "HTTP服务设置已经成功的修改.", "Modification des paramètres de connexion HTTP", "Настройки HTTTP - служб были изменены", "La configuración de servicio de http ha sido modificada satisfactoriamente", "تم تعديل إعدادات خدمة HTTP بنجاح"];
	var net_safe_8 = ["NTP network calibration", "NTP网络校准时间.", "Temps d 'étalonnage de réseau NTP", "время калибровки сети NTP", "Tiempo de calibración.", "وقت معايرة شبكة NTP"];
	var net_safe_9 = ["NTP local calibration", "NTP本地自定义校准时间.", "Local Self - Definition Calibration Time", "время настройки NTP локально", "NTP local personalization time", "NTP المحلي معايرة الوقت"];
	var net_safe_10 = ["FTP configuration was changed.", "FTP设置已经成功的修改.", "Modifications apportées avec succès aux paramètres FTP", "Настройки FTP были успешно изменены", "Configuración FTP modificada con éxito", "تم تعديل إعدادات FTP بنجاح"];
	var net_safe_11 = ["SMTP configuration was changed.", "SMTP设置已经成功的修改.", "Modifications apportées avec succès aux paramètres SMTP", "Настройки SMTP были успешно изменены", "La configuración SMTP ha sido modificada con éxito.", "تم تعديل إعدادات SMTP بنجاح"];
	var net_safe_12 = ["MAC configuration was changed.", "MAC滤池设置已经成功的修改.", "Modifications apportées avec succès aux paramètres MAC", "Настройки фильтра MAC были изменены", "La configuración del filtro Mac se ha modificado con éxito.", "تم تعديل إعدادات فلتر MAC بنجاح"];
	var net_safe_13 = ["Telnet/SSH configuration was changed.", "Telnet/SSH设置已经成功的修改.", "Modifications apportées avec succès aux paramètres Telnet/SSH", "Настройки Telnet / SSH были изменены", "La configuración de Internet / SSH ha sido modificada con éxito.", "تم تعديل إعدادات Telnet / SSH بنجاح"];
	var net_safe_14 = ["Modbus configuration was changed.", "Modbus设置已经成功的修改.", "Modifications apportées avec succès aux paramètres Modbus", "Настройки Modbus были изменены", "Modificación exitosa de la configuración de modbus", "تم تعديل إعدادات Modbus بنجاح"];
	var net_safe_15 = ["SNMP v1/v2 configuration was changed.", "SNMP v1/v2设置已经成功的修改.", "Modifications apportées avec succès aux paramètres SNMP v1/v2", "Настройки SNMP v1 / v2 были изменены", "Cambios exitosos en la configuración de SNMP V1 / V2", "تم تعديل إعدادات SNMP v1 / v2 بنجاح"];
	var net_safe_16 = ["SNMP v3 configuration was changed.", "SNMP v3设置已经成功的修改.", "Modifications apportées avec succès aux paramètres SNMP v3", "Настройки SNMP v3 были изменены", "Cambios exitosos en la configuración de SNMP V3", "تم تعديل إعدادات SNMP v3 بنجاح"];
	var net_safe_17 = ["Radius configuration was changed.", "Radius设置已经成功的修改.", "Modifications apportées avec succès aux paramètres Radius", "Настройки Radius были изменены", "Cambios exitosos en la configuración de RADIUS", "تم تعديل إعدادات نصف القطر بنجاح"];
	var net_safe_18 = ["Syslog configuration was changed.", "Syslog设置已经成功的修改.", "Modifications apportées avec succès aux paramètres Syslog", "Настройки Syslog были изменены", "La configuración syslog ha sido modificada con éxito.", "تم تعديل إعدادات Syslog بنجاح"];
	var net_safe_19 = ["LDAP configuration was changed.", "LDAP设置已经成功的修改.", "Modifications apportées avec succès aux paramètres LDAP", "Настройки LDAP были изменены", "Cambios exitosos en la configuración de LDAP", "تم تعديل إعدادات LDAP بنجاح"];
	
	var usr_manage_1 = ["Administration", "用户管理", "Gestion des utilisateurs", "Управление пользователями", "Gestión de usuarios", "إدارة المستخدم"];
	var usr_manage_2 = ["User", "用户", "Utilisateur", "пользователь", "Usuario", "المستخدم"];
	var usr_manage_3 = ["was successfully deleted.", "已经成功删除.", "was successfully deleted", "Удалено", "Eliminado con éxito", "تم حذفه بنجاح"];
	var usr_manage_4 = ["be added to the list of users.", "被添加到用户列表.", "Ajouter à la liste des utilisateurs", "Добавить в список пользователей", "Lista de usuarios", "تمت الإضافة إلى قائمة المستخدمين"];
	var usr_manage_5 = ["the information is successfully changed.", "信息被成功的改变了.", "L'information a changé.", "Сообщение было изменено успешно", "La información ha cambiado con éxito.", "تم تغيير المعلومات بنجاح"];
	var usr_manage_6 = ["User group", "用户组", "Groupe d 'utilisateurs", "группа пользователей", "Grupo de usuarios", "مجموعة المستخدم"];
	var usr_manage_7 = ["the information is successfully changed.", "信息被成功修改.", "L'information a changé.", "Сообщение было изменён", "Mensaje modificado con éxito", "تم تعديل المعلومات بنجاح"];
	var usr_manage_8 = ["User group outlet permission", "用户组输出位权限", "Droits de sortie de groupe d 'utilisateurs", "права на выход из группы пользователей", "Permisos de salida del Grupo de usuarios", "مجموعة بت إذن المستخدم الإخراج"];
	var usr_manage_9 = ["configuration was successfully changed.", "设置已经成功的修改.", "Paramétrer les modifications réussies", "Настройка успешно изменённых", "Configuración de los cambios exitosos", "قم بإعداد تعديل ناجح"];
	
	var sys_command_1 = ["System Command", "系统命令", "Système de commande", "системная команда", "Orden del sistema", "قيادة النظام"];
	var sys_command_2 = ["Restart Device.", "重启设备.", "Redémarreur", "Перезагрузить устройство", "Dispositivo de reinicio", "أعد تشغيل الجهاز"];
	var sys_command_3 = ["Restart to default setting.", "恢复出厂设置.", "Restauration des paramètres de sortie", "восстановить настройки выхода", "Restaurar configuración de fábrica", "إعادة ضبط المصنع"];
	var sys_command_4 = ["Logout.", "登录退出.", "Quitter", "вход выход", "Salir intr.", "تسجيل الدخول لتسجيل الخروج"];
	var arr_22 = ["No matching log.", "没有更多日志", "Pas plus de détails.", "Больше никаких журналов", "Sin más", "لا مزيد من السجلات"];

	$.ajax({
		dataType:"text",
		url:"/operatelog?id1="+pg,
		async:true,
		cache:false,
		success:function(sta)
		{
			if(sta=="err1")
			{
				for(var i=0;i<24;i++)
				{
					document.getElementById("tr"+i).style.display="none";
				}
				alert(arr_22[flag]);
				return;
			}
			
			var gv = new Array();
			gv=sta.split("?");
			var k=0;
			document.getElementById("tpg").innerHTML=gv[0];
			document.getElementById("size").innerHTML=gv[0];
			for(var i=0;i<24;i++)
			{
				if(gv[i*4+1])
				{
					if(k%2!=0)
						document.getElementById("tr"+i).style.background="#f0f0f0";
					else
						document.getElementById("tr"+i).style.background="#ffffff";
					k++;
				
					document.getElementById("tr"+i).style.display="";
					document.getElementById("a"+i).innerHTML=(parseInt(pg)-1)*24+i+1;
					document.getElementById("b"+i).innerHTML=gv[i*4+1];
					document.getElementById("c"+i).innerHTML=gv[i*4+3];
				
					if(gv[i*4+2]=="1")//用户登录
					{
						document.getElementById("d"+i).innerHTML=usr_login_1[flag];
						document.getElementById("e"+i).innerHTML=usr_login_2[flag];
						
					}
					else if(gv[i*4+2]=="2")//设备设置
					{
						document.getElementById("d"+i).innerHTML=dev_setup_1[flag];
						document.getElementById("e"+i).innerHTML=dev_setup_2[flag];
					}
					else if(gv[i*4+2]=="3")
					{
						document.getElementById("d"+i).innerHTML=dev_setup_1[flag];
						document.getElementById("e"+i).innerHTML=dev_setup_3[flag];
					}
					else if(gv[i*4+2]=="4")
					{
						document.getElementById("d"+i).innerHTML=dev_setup_1[flag];
						document.getElementById("e"+i).innerHTML=gv[i*4+4]+dev_setup_4[flag];
					}
					else if(gv[i*4+2]=="5")
					{
						document.getElementById("d"+i).innerHTML=dev_setup_1[flag];
						document.getElementById("e"+i).innerHTML=gv[i*4+4]+dev_setup_5[flag];
					}
					else if(gv[i*4+2]=="6")
					{
						document.getElementById("d"+i).innerHTML=dev_setup_1[flag];
						document.getElementById("e"+i).innerHTML=gv[i*4+4]+dev_setup_6[flag];
					}
					else if(gv[i*4+2]=="7")
					{
						document.getElementById("d"+i).innerHTML=dev_setup_1[flag];
						document.getElementById("e"+i).innerHTML=gv[i*4+4]+dev_setup_7[flag];
					}
					else if(gv[i*4+2]=="8")
					{
						document.getElementById("d"+i).innerHTML=dev_setup_1[flag];
						document.getElementById("e"+i).innerHTML=gv[i*4+4]+dev_setup_8[flag];
					}
					else if(gv[i*4+2]=="9")
					{
						document.getElementById("d"+i).innerHTML=dev_setup_1[flag];
						document.getElementById("e"+i).innerHTML=gv[i*4+4]+dev_setup_9[flag];
					}
					else if(gv[i*4+2]=="10")
					{
						document.getElementById("d"+i).innerHTML=dev_setup_1[flag];
						document.getElementById("e"+i).innerHTML=gv[i*4+4]+dev_setup_10[flag];
					}
					else if(gv[i*4+2]=="11")
					{
					
						var action = new Array();
						action=gv[i*4+4].split("&");
						var mode=action[2]==1?"Web":(action[2]==2?"SNMP":(action[2]==3?"Telnet&SSH":(action[2]==4?"Overrun":(action[2]==5?"Modbus":(action[2]==6?"Manager":(action[2]==7?"Timer switch":(action[2]==8?"Slave":"ping")))))));
						document.getElementById("c"+i).innerHTML=mode;
						document.getElementById("d"+i).innerHTML=dev_setup_11[flag];
						document.getElementById("e"+i).innerHTML=dev_setup_12[flag]+mode+dev_setup_13[flag]+action[0]+dev_setup_14[flag]+action[1]+dev_setup_15[flag];
					}
					else if(gv[i*4+2]=="12")//网络安全
					{
						document.getElementById("d"+i).innerHTML=net_safe_1[flag];
						document.getElementById("e"+i).innerHTML=net_safe_2[flag];
					}
					else if(gv[i*4+2]=="13")
					{
						document.getElementById("d"+i).innerHTML=net_safe_1[flag];
						document.getElementById("e"+i).innerHTML=net_safe_3[flag];
					}
					else if(gv[i*4+2]=="14")
					{
						document.getElementById("d"+i).innerHTML=net_safe_1[flag];
						document.getElementById("e"+i).innerHTML=net_safe_4[flag];
					}
					else if(gv[i*4+2]=="15")
					{
						document.getElementById("d"+i).innerHTML=net_safe_1[flag];
						document.getElementById("e"+i).innerHTML=net_safe_5[flag];
					}
					else if(gv[i*4+2]=="16")
					{
						document.getElementById("d"+i).innerHTML=net_safe_1[flag];
						document.getElementById("e"+i).innerHTML=net_safe_6[flag];
					}
					else if(gv[i*4+2]=="17")
					{
						document.getElementById("d"+i).innerHTML=net_safe_1[flag];
						document.getElementById("e"+i).innerHTML=net_safe_7[flag];
					}
					else if(gv[i*4+2]=="18")
					{
						document.getElementById("d"+i).innerHTML=net_safe_1[flag];
						document.getElementById("e"+i).innerHTML=net_safe_8[flag];
					}
					else if(gv[i*4+2]=="19")
					{
						document.getElementById("d"+i).innerHTML=net_safe_1[flag];
						document.getElementById("e"+i).innerHTML=net_safe_9[flag];
					}
					else if(gv[i*4+2]=="20")
					{
						document.getElementById("d"+i).innerHTML=net_safe_1[flag];
						document.getElementById("e"+i).innerHTML=net_safe_10[flag];
					}
					else if(gv[i*4+2]=="21")
					{
						document.getElementById("d"+i).innerHTML=net_safe_1[flag];
						document.getElementById("e"+i).innerHTML=net_safe_11[flag];
					}
					else if(gv[i*4+2]=="22")
					{
						document.getElementById("d"+i).innerHTML=net_safe_1[flag];
						document.getElementById("e"+i).innerHTML=net_safe_12[flag];
					}
					else if(gv[i*4+2]=="23")
					{
						document.getElementById("d"+i).innerHTML=net_safe_1[flag];
						document.getElementById("e"+i).innerHTML=net_safe_13[flag];
					}
					else if(gv[i*4+2]=="24")
					{
						document.getElementById("d"+i).innerHTML=net_safe_1[flag];
						document.getElementById("e"+i).innerHTML=net_safe_14[flag];
					}
					else if(gv[i*4+2]=="25")
					{
						document.getElementById("d"+i).innerHTML=net_safe_1[flag];
						document.getElementById("e"+i).innerHTML=net_safe_15[flag];
					}
					else if(gv[i*4+2]=="26")
					{
						document.getElementById("d"+i).innerHTML=net_safe_1[flag];
						document.getElementById("e"+i).innerHTML=net_safe_16[flag];
					}
					else if(gv[i*4+2]=="27")
					{
						document.getElementById("d"+i).innerHTML=net_safe_1[flag];
						document.getElementById("e"+i).innerHTML=net_safe_17[flag];
					}
					else if(gv[i*4+2]=="28")
					{
						document.getElementById("d"+i).innerHTML=net_safe_1[flag];
						document.getElementById("e"+i).innerHTML=net_safe_18[flag];
					}
					else if(gv[i*4+2]=="29")
					{
						document.getElementById("d"+i).innerHTML=net_safe_1[flag];
						document.getElementById("e"+i).innerHTML=net_safe_19[flag];
					}
					else if(gv[i*4+2]=="30")//用户管理
					{
						document.getElementById("d"+i).innerHTML=usr_manage_1[flag];
						document.getElementById("e"+i).innerHTML=usr_manage_2[flag]+gv[i*4+4]+usr_manage_3[flag];
					}
					else if(gv[i*4+2]=="31")
					{
						document.getElementById("d"+i).innerHTML=usr_manage_1[flag];
						document.getElementById("e"+i).innerHTML=usr_manage_2[flag]+gv[i*4+4]+usr_manage_4[flag];
					}
					else if(gv[i*4+2]=="32")
					{
						document.getElementById("d"+i).innerHTML=usr_manage_1[flag];
						document.getElementById("e"+i).innerHTML=usr_manage_2[flag]+gv[i*4+4]+usr_manage_5[flag];
					}
					else if(gv[i*4+2]=="33")
					{
						document.getElementById("d"+i).innerHTML=usr_manage_1[flag];
						document.getElementById("e"+i).innerHTML=usr_manage_2[flag]+gv[i*4+4]+usr_manage_7[flag];
					}
					else if(gv[i*4+2]=="34")
					{
						document.getElementById("d"+i).innerHTML=usr_manage_1[flag];
						document.getElementById("e"+i).innerHTML=usr_manage_6[flag]+gv[i*4+4]+usr_manage_3[flag];
					}
					else if(gv[i*4+2]=="35")
					{
						document.getElementById("d"+i).innerHTML=usr_manage_1[flag];
						document.getElementById("e"+i).innerHTML=usr_manage_6[flag]+gv[i*4+4]+usr_manage_9[flag];
					}
					else if(gv[i*4+2]=="36")//系统命令
					{
						document.getElementById("d"+i).innerHTML=sys_command_1[flag];
						document.getElementById("e"+i).innerHTML=sys_command_2[flag];
					}
					else if(gv[i*4+2]=="37")
					{
						document.getElementById("d"+i).innerHTML=sys_command_1[flag];
						document.getElementById("e"+i).innerHTML=sys_command_3[flag];
					}
					else if(gv[i*4+2]=="38")
					{
						document.getElementById("d"+i).innerHTML=sys_command_1[flag];
						document.getElementById("e"+i).innerHTML=sys_command_4[flag];
					}
					
				}
				else
				{
					document.getElementById("tr"+i).style.display="none";
				}
			}
		}
	});
		
}

function clearlogs()
{
	if(flag==0)
	{
		if(confirm("Are you sure to delete the log?"))
		{
			$.ajax({
				dataType:"text",
				url:"/clearlogs",
				async:true,
				cache:false,
				success:function(sta)
				{
					if(sta=="OK")
					{
						alert("The log is successfully deleted.");
						window.location.reload();	
					}
					else if(sta=="flase")
					{
						alert("No permission!");
					}
				}
			});
		}
	}
	else
	{
		if(confirm("你确定要删除日志记录?"))
		{
			$.ajax({
				dataType:"text",
				url:"/clearlogs",
				async:true,
				cache:false,
				success:function(sta)
				{
					if(sta=="OK")
					{
						alert("成功删除日志记录.");
						window.location.reload();	
					}
					else if(sta=="flase")
					{
						alert("无权限!");
					}
				}
			});
		}
	}
}


//打印表格
var idTmr;

function getExplorer()
{
    var explorer = window.navigator.userAgent;
	if(IEVersion()>=6||IEVersion()=='edge')
	{
		return 'ie';
	}
	else
	{
		//ie
		//if (explorer.indexOf("MSIE") >= 0)
		//{
		//	return 'ie';
		//}
		//firefox
		if (explorer.indexOf("Firefox") >= 0)
		{
			return 'Firefox';
		}
		//Chrome
		else if (explorer.indexOf("Chrome") >= 0)
		{
			return 'Chrome';
		}
		//Opera
		else if (explorer.indexOf("Opera") >= 0)
		{
			return 'Opera';
		}
		//Safari
		else if (explorer.indexOf("Safari") >= 0)
		{
			return 'Safari';
		}		
	}
}
function IEVersion() {
            var userAgent = navigator.userAgent; //取得浏览器的userAgent字符串  
            var isIE = userAgent.indexOf("compatible") > -1 && userAgent.indexOf("MSIE") > -1; //判断是否IE<11浏览器  
            var isEdge = userAgent.indexOf("Edge") > -1 && !isIE; //判断是否IE的Edge浏览器  
            var isIE11 = userAgent.indexOf('Trident') > -1 && userAgent.indexOf("rv:11.0") > -1;
            if(isIE) {
                var reIE = new RegExp("MSIE (\\d+\\.\\d+);");
                reIE.test(userAgent);
                var fIEVersion = parseFloat(RegExp["$1"]);
                if(fIEVersion == 7) {
                    return 7;
                } else if(fIEVersion == 8) {
                    return 8;
                } else if(fIEVersion == 9) {
                    return 9;
                } else if(fIEVersion == 10) {
                    return 10;
                } else {
                    return 6;//IE版本<=7
                }   
            } else if(isEdge) {
                return 'edge';//edge
            } else if(isIE11) {
                return 11; //IE11  
            }else{
                return -1;//不是ie浏览器
            }
}
function method5(tableid) {
	if (getExplorer() == 'ie')
	{		  
		  try {
				var oXL = new ActiveXObject("Excel.Application"); 
				}catch(e) 
				{
					if(flag==0)
					{
						alert( "The installation of EXCEL is required to export the table. And the use of 'ACTIVEX CONTROLS' is also required for browsing the table. In IE safety settings choose 'Initialize and script Activex controls not marked as safe' option.");
					}
					else
					{
						alert( "要导出该表，您必须安装Excel电子表格软件，同时浏览器须使用“ActiveX 控件”，在IE的安全设置里启用“对未标记为可安全执行脚本的ActiveX控件初始化并执行脚本”项。");
					}
					return "";
				}
		
		
			var curTbl = document.getElementById(tableid); 	
			var oWB = oXL.Workbooks.Add(); 
			var oSheet = oWB.ActiveSheet; 
			var Lenr = curTbl.rows.length; 
			for (i = 0; i < Lenr; i++) 
			{ 
				var Lenc = curTbl.rows(i).cells.length; 
				for (j = 0; j < Lenc; j++) 
				{ 
					oSheet.Cells(i + 1, j + 1).value = curTbl.rows(i).cells(j).innerText; 
				 } 
			} 
			oXL.Visible = true; 	  		
	} 
	else
	{
		tableToExcel(tableid)
	}
}
function Cleanup() {
	window.clearInterval(idTmr);
	CollectGarbage();
}
var tableToExcel = (function() {
	var uri = 'data:application/vnd.ms-excel;base64,',
		template = '<html><head><meta charset="UTF-8"></head><body><table  border="1">{table}</table></body></html>',
		base64 = function(
			s) {
			return window.btoa(unescape(encodeURIComponent(s)))
		},
		format = function(s, c) {
			return s.replace(/{(\w+)}/g, function(m, p) {
				return c[p];
			})
		}
	return function(table, name) {
		if(!table.nodeType)
			table = document.getElementById(table)
		var ctx = {
			worksheet: name || 'Worksheet',
			table: table.innerHTML
		}
	//	window.location.href = uri + base64(format(template, ctx))
		
		document.getElementById("dlink").href = uri + base64(format(template, ctx));
		document.getElementById("dlink").download = 'operatelog.xls';//这里是关键所在,当点击之后,设置a标签的属性,这样就可以更改标签的标题了
		document.getElementById("dlink").click();
	}
})()


</script>
</head>
<body>
<div style="padding: 0px; margin-bottom: 0.8%; overflow: hidden; ">
	<div class="box" style="float: left; width: 100%; margin-bottom: 0.8%; height:96%; background:#e7e7e7;">
		<div class="panel panel-default">
			<div class="panel-heading" ><i class="fa fa-area-chart fa-lg" style="padding-right: 5px;" ></i ><span id="lang_1"></span></div>			
		</div>
		<div style="border:1px solid;border-color: #ffffff; margin:10px; height:775px; background:#ffffff;">

			<table border="0" id="dataTable" width="100%" style="font-size:12px; text-align:center;">
				<tr align="left" style="color:#000000;background:#e7e7e7; height:30px; text-align:center">
					<td width="4% "><b id="lang_2"></b></td>
					<td width="10%"><b id="lang_3"></b></td>
					<td width="10%"><b id="lang_4"></b></td>
					<td width="10%"><b id="lang_5"></b></td>
					<td width="66%"><b id="lang_6"></b></td>
				</tr>
				<tr id="tr0" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a0" align="center"></td>
					<td id="b0"></td>
					<td id="c0"></td>
					<td id="d0"></td>
					<td id="e0"></td>
				</tr>
				<tr id="tr1" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a1" align="center"></td>
					<td id="b1"></td>
					<td id="c1"></td>
					<td id="d1"></td>
					<td id="e1"></td>
				</tr>
				<tr id="tr2" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a2" align="center"></td>
					<td id="b2"></td>
					<td id="c2"></td>
					<td id="d2"></td>
					<td id="e2"></td>
				</tr>
				<tr id="tr3" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a3" align="center"></td>
					<td id="b3"></td>
					<td id="c3"></td>
					<td id="d3"></td>
					<td id="e3"></td>
				</tr>
				<tr id="tr4" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a4" align="center"></td>
					<td id="b4"></td>
					<td id="c4"></td>
					<td id="d4"></td>
					<td id="e4"></td>
				</tr>
				<tr id="tr5" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a5" align="center"></td>
					<td id="b5"></td>
					<td id="c5"></td>
					<td id="d5"></td>
					<td id="e5"></td>
				</tr>
				<tr id="tr6" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a6" align="center"></td>
					<td id="b6"></td>
					<td id="c6"></td>
					<td id="d6"></td>
					<td id="e6"></td>
				</tr>
				<tr id="tr7" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a7" align="center"></td>
					<td id="b7"></td>
					<td id="c7"></td>
					<td id="d7"></td>
					<td id="e7"></td>
				</tr>
				<tr id="tr8" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a8" align="center"></td>
					<td id="b8"></td>
					<td id="c8"></td>
					<td id="d8"></td>
					<td id="e8"></td>
				</tr>
				<tr id="tr9" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a9" align="center"></td>
					<td id="b9"></td>
					<td id="c9"></td>
					<td id="d9"></td>
					<td id="e9"></td>
				</tr>
				<tr id="tr10" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a10" align="center"></td>
					<td id="b10"></td>
					<td id="c10"></td>
					<td id="d10"></td>
					<td id="e10"></td>
				</tr>
				<tr id="tr11" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a11" align="center"></td>
					<td id="b11"></td>
					<td id="c11"></td>
					<td id="d11"></td>
					<td id="e11"></td>
				</tr>
				<tr id="tr12" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a12" align="center"></td>
					<td id="b12"></td>
					<td id="c12"></td>
					<td id="d12"></td>
					<td id="e12"></td>
				</tr>
				<tr id="tr13" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a13" align="center"></td>
					<td id="b13"></td>
					<td id="c13"></td>
					<td id="d13"></td>
					<td id="e13"></td>
				</tr>
				<tr id="tr14" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a14" align="center"></td>
					<td id="b14"></td>
					<td id="c14"></td>
					<td id="d14"></td>
					<td id="e14"></td>
				</tr>
				<tr id="tr15" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a15" align="center"></td>
					<td id="b15"></td>
					<td id="c15"></td>
					<td id="d15"></td>
					<td id="e15"></td>
				</tr>
				<tr id="tr16" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a16" align="center"></td>
					<td id="b16"></td>
					<td id="c16"></td>
					<td id="d16"></td>
					<td id="e16"></td>
				</tr>
				<tr id="tr17" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a17" align="center"></td>
					<td id="b17"></td>
					<td id="c17"></td>
					<td id="d17"></td>
					<td id="e17"></td>
				</tr>
				<tr id="tr18" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a18" align="center"></td>
					<td id="b18"></td>
					<td id="c18"></td>
					<td id="d18"></td>
					<td id="e18"></td>
				</tr>
				<tr id="tr19" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a19" align="center"></td>
					<td id="b19"></td>
					<td id="c19"></td>
					<td id="d19"></td>
					<td id="e19"></td>
				</tr>
				<tr id="tr20" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a20" align="center"></td>
					<td id="b20"></td>
					<td id="c20"></td>
					<td id="d20"></td>
					<td id="e20"></td>
				</tr>
				<tr id="tr21" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a21" align="center"></td>
					<td id="b21"></td>
					<td id="c21"></td>
					<td id="d21"></td>
					<td id="e21"></td>
				</tr>
				<tr id="tr22" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a22" align="center"></td>
					<td id="b22"></td>
					<td id="c22"></td>
					<td id="d22"></td>
					<td id="e22"></td>
				</tr>
				<tr id="tr23" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a23" align="center"></td>
					<td id="b23"></td>
					<td id="c23"></td>
					<td id="d23"></td>
					<td id="e23"></td>
				</tr>
				<tr style="height:50px; white-space:nowrap;">
					<td colspan="4"></td>
					<td style="text-align:right;">
						<b id="lang_7"></b><b id="size"></b><b>KB</b>&nbsp;&nbsp;
						<b id="lang_8"></b>&nbsp;<b><input id="pg" style="width:50px;"></input></b>&nbsp;<b id="lang_9"></b>&nbsp;<b id="tpg"></b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						<input id="lang_10" style="position:relative; height:21px; width:90px; margin-right:2%;" type="button" onClick="gotopage();"></input>
						<input id="lang_11" style="position:relative; height:21px; width:90px; margin-right:2%;" type="button" onClick="front();"></input>
						<input id="lang_12" style="position:relative; height:21px; width:90px; margin-right:2%;" type="button" onClick="next();"></input>
						<input id="lang_13" style="position:relative; height:21px; width:90px; margin-right:2%;" type="button" onClick="clearlogs();"></input>
						<a id="dlink"  style="display:none;"></a>
						<input id="lang_14" style="position:relative; height:21px; width:90px; margin-right:5%;" type="button" id="excell" onclick="method5('dataTable');"></input>
					</td>
				</tr>
				
			</table>
		</div>
    </div>   
</div>
</body>
</html>

