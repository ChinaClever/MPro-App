<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>PDU</title>
<link rel="stylesheet" href="../js/bootstrap/css/bootstrap.min.css" />	
<link rel="stylesheet" href="../css/font-awesome.min.css">
<link rel="stylesheet" href="../css/style.css" />
<script type="text/javascript" src="../js/jquery-1.8.3.min.js"></script>
<style type="text/css">
.panel-default{
            border: none;
            border-radius: 0px;
            margin-bottom: 0px;
            box-shadow: none;
            -webkit-box-shadow: none;
}

.panel-default > .panel-heading{
	color: #222;
	font-size:13px;
	background-color: #fff;
	border-color: #e6e6e6;
	padding: 10px 12px;
}

body{ 
	
	background: #fafafa;
}

tr{
	height:28px;
}
</style>

<script>
var flag;
var pg;
$(document).ready(function () {
	$.ajax({
			dataType:"text",
			url:"/npmslavelist",
			cache:false,
			success:function(sta)
			{
				var gv = new Array();
				gv=sta.split("?");
				flag = parseInt(gv[0]);
				LangFun();

				pg =  document.getElementById("pg").value;
				if(pg=="")
				{
					pg = "1";
					document.getElementById("pg").value=pg;
				}
				loadpage(pg);
			}
		});		
		//setInterval("loadpage(pg);",2000);
});

function mov(obj)
{
	obj.style.background="#f9fae8";
}

function movout(obj)
{
	var index=obj.id.replace("tr","");
	if(parseInt(index)%2!=0)
		obj.style.background="#f0f0f0";
	else
		obj.style.background="#ffffff";
}

function LangFun()
{
	var lang_1  = ["Alarm logs", "告警日志", "Journal d 'alerte", "журнал оповещения", "Registro de alerta", ""];
	var lang_2  = ["No.", "序号", "Numéro de série", "порядковый номер", "Número", ""];
	var lang_3  = ["Time", "时间", "Temps", "время", "Tiempo", ""];
	var lang_4  = ["Alarm level", "警告类型", "Niveau", "тип предупреждения", "Tipo de advertencia", ""];
	var lang_5  = ["Alarm type", "名称类别", "Alarm type", "номенклатура", "Tipo de nombre", ""];
	var lang_6  = ["Description", "详细描述", "Description", "описание", "Descripción detallada", ""];
	var lang_7  = ["Log size：", "日志大小：", "Taille du Journal", "размер журнала", "Tamaño del registro", ""];
	var lang_8  = ["Page", "页", "Page", "страница", "Página", ""];
	var lang_9  = ["to", "至", "to", "совершенный", "A", ""];
	var lang_10 = ["Go", "前往", "Allez", "отправиться", "Ir", ""];
	var lang_11 = ["Previous page", "前一页", "Page précédente", "Предыдущая страница", "En un rincón", ""];
	var lang_12 = ["Next page", "后一页", "Page suivante", "Последняя страница", "Después de ti", ""];
	var lang_13 = ["Delete logs", "删除日志", "Supprimer le journal", "Удалить журнал", "Borrar registro", ""];
	var lang_14 = ["Export logs", "导出", "Journal d 'exportation", "производный", "Exportación", ""];

	document.getElementById("lang_1") .innerHTML = lang_1[flag];
	document.getElementById("lang_2") .innerHTML = lang_2[flag];
	document.getElementById("lang_3") .innerHTML = lang_3[flag];
	document.getElementById("lang_4") .innerHTML = lang_4[flag];
	document.getElementById("lang_5") .innerHTML = lang_5[flag];
	document.getElementById("lang_6") .innerHTML = lang_6[flag];
	document.getElementById("lang_7") .innerHTML = lang_7[flag];
	document.getElementById("lang_8") .innerHTML = lang_8[flag];
	document.getElementById("lang_9") .innerHTML = lang_9[flag];
	document.getElementById("lang_10").value = lang_10[flag];
	document.getElementById("lang_11").value = lang_11[flag];
	document.getElementById("lang_12").value = lang_12[flag];
	document.getElementById("lang_13").value = lang_13[flag];
	document.getElementById("lang_14").value = lang_14[flag];
}


function gotopage()
{
	var pg =  document.getElementById("pg").value;
	if(pg=="")
	{
		pg = "1";
		document.getElementById("pg").value=pg;
	}
	loadpage(pg);
}
function front()
{
	var pg =  document.getElementById("pg").value;
	if(pg=="")
	{
		pg = "1";
		document.getElementById("pg").value=pg;
	}
	var page = parseInt(pg)-1;
	if(page<1)
	{
		return;
	}
	document.getElementById("pg").value=page;
	loadpage(page);
}
function next()
{
	var pg =  document.getElementById("pg").value;
	if(pg=="")
	{
		pg = "1";
		document.getElementById("pg").value=pg;
	}
	var page = parseInt(pg)+1;
	document.getElementById("pg").value=page;
	loadpage(page);
}
function loadpage(pg)
{	
	var arr_1 = ["output", "输出位", "output", "выходной бит", "Salida de salida", "الانتاج قليلا"];
	var arr_2 = ["(Device name->Output name) occured ", "(设备名称->输出位名称)发生", "(Nom du périphérique->Nom)Se produire", "(Название устройства->выходной бит)произойти", "(nombre del dispositivo - > nombre de la salida)Pasar", "(اسم الجهاز -> اسم بت الإخراج) يحدث"];
	var arr_3 = ["current value ", "当前值为", "Valeur actuelle", "текущее значение", "Valor actual", "القيمة الحالية"];
	var arr_4 = ["output group", "输出组", "Groupe de sortie", "выходной блок", "Grupo de salida", "مجموعة الإخراج"];
	var arr_5 = ["(Device name->Output name) occured ", "(设备名称->输出组名称)发生", "(Nom du périphérique->Nom)Se produire", "(Название устройства->Имя группы вывода)произойти", "(nombre del dispositivo - > nombre del Grupo de salida)", "(اسم الجهاز -> اسم مجموعة الإخراج) يحدث"];
	
	var arr_66 = ["Loop current", "回路电流", "Circuit", "ток контура", "Corriente de retorno", "حلقة الحالية"];
	var arr_77 = ["(Device name->Loop current name) occured ", "(设备名称->回路电流名称)发生", "(Nom du périphérique->Nom)Se produire", "(Название устройства->наименование тока контура)произойти", "(nombre del dispositivo - > nombre de la corriente de retorno)", "(اسم الجهاز -> حلقة الاسم الحالي) يحدث"];
	
	var arr_6 = ["Phase current", "相电流", "Courant de phase", "фазовый ток", "Corriente de fase", "المرحلة الحالية"];
	var arr_7 = ["(Device name->Phase current name) occured ", "(设备名称->相电流名称)发生", "(Nom du périphérique->Nom)Se produire", "(Название устройства->наименование фазового тока)произойти", "(nombre del dispositivo - > nombre de la corriente de fase)", "(اسم الجهاز -> المرحلة الحالية الاسم) يحدث"];
	var arr_8 = ["Phase voltage", "相电压", "Tension de phase", "фазовое напряжение", "Tensión de fase", "الجهد المرحلة"];
	var arr_9 = ["(Device name->Phase voltage name) occured ", "(设备名称->回路电压名称)发生", "(Nom du périphérique->Nom)Se produire", "(Название устройства->наименование тока контура)произойти", "(nombre del dispositivo - > nombre del voltaje de circuito)", "(اسم الجهاز -> اسم الجهد حلقة) يحدث"];
	var arr_10 = ["Temperature sensor", "温度传感器", "Capteur de température", "датчик температуры", "Sensor de temperatura", "جهاز استشعار درجة الحرارة"];
	var arr_11 = ["(Device name->Temperature sensor name) occured ", "(设备名称->温度传感器名称)发生", "(Nom du périphérique->Nom)Se produire", "(Название устройства->наименование датчик температуры)произойти", "(nombre del dispositivo - > nombre del sensor de temperatura)", "(اسم الجهاز -> اسم جهاز استشعار درجة الحرارة) يحدث"];
	var arr_12 = ["Humidity sensor", "湿度传感器", "Capteur d 'humidité", "датчик температуры", "Sensor de humedad", "جهاز استشعار الرطوبة"];
	var arr_13 = ["(Device name->Humidity sensor name) occured ", "(设备名称->湿度传感器名称)发生", "(Nom du périphérique->Nom)Se produire", "(Название устройства->наименование датчика влажности)произойти", "(nombre del dispositivo - > nombre del sensor de temperatura)", "(اسم الجهاز -> اسم جهاز استشعار الرطوبة) يحدث"];
	var arr_14 = ["Door alarming", "门禁传感器告警", "Détecteur d 'accès", "сигнализация датчика", "Sensores de Seguridad", "إنذار استشعار الوصول"];
	var arr_15 = ["(Device name->Door sensor name) is opened ", "(设备名称->传感器名称)被打开", "(Nom du périphérique->Nom)Se produire", "(Название устройства->наименование датчика)открыть", "(nombre del dispositivo - > nombre del sensor) abierto", "(اسم الجهاز -> اسم المستشعر) قيد التشغيل"];
	var arr_16 = ["Smoke sensor alarming", "烟雾传感器告警", "Détecteur de fumée", "Предупреждение дымовых датчиков", "Detector de humo", "جهاز استشعار الدخان الانذار"];
	var arr_17 = ["(Device name->Smoke sensor name)is alarming", "(设备名称->烟雾传感器名称)告警", "(Nom du périphérique->Nom)Se produire", "(Название устройства->наименование датчика)предупреждать", "Nombre del dispositivo - > nombre del sensor de humo", "(اسم الجهاز -> الدخان اسم الاستشعار) التنبيه"];
	var arr_18 = ["Water snesor alarming", "水浸传感器告警", "Capteur d 'immersion", "оповещение датчика погружения", "Sensores de inmersión", "إنذار استشعار الفيضانات"];
	var arr_19 = ["(Device name->water sensor name)is alarming", "(设备名称->断路器名称)告警", "(Nom du périphérique->Nom)Se produire", "(Название устройства->имя прерывателя)предупреждать", "Nombre del dispositivo - > nombre del disyuntor", "(اسم الجهاز -> اسم الكسارة) التنبيه"];
	var arr_20 = ["breaker alarming", "断路器告警", "Disjoncteur d 'alarme", "Предупреждение прерывателя", "Interruptor de alarma", "إنذار قاطع الدائرة"];
	var arr_21 = ["(Device name->breaker name)is alarming", "(设备名称->断路器名称)告警", "(Nom du périphérique->Nom)Se produire", "(Название устройства->имя прерывателя)предупреждать", "Nombre del dispositivo - > nombre del disyuntor", "(اسم الجهاز -> اسم الكسارة) التنبيه"];
	var arr_22 = ["No matching log.", "没有更多日志", "Rien de plus", "No matching log", "Sin más", "لا مزيد من السجلات"];
	var arr_23 = ["Door alarming lifted", "门禁传感器告警解除", "Alerte désactivée.", "выключение сигнализации", "Sensores de Seguridad desactivados.", "جهاز استشعار لمراقبة الدخول الإفراج عن إنذار"];
	var arr_24 = ["(Device name->Door sensor name)is closed ", "(设备名称->传感器名称)被重新关闭", "(Nom du périphérique->Nom)Se produire", "(Название устройства - > Название датчика) вновь закрыто", "(nombre del dispositivo - > nombre del sensor) cerrado de nuevo", "(اسم الجهاز -> اسم المستشعر) مغلق مرة أخرى"];
	var arr_25 = ["Smoke sensor alarming lifted", "烟雾传感器告警解除", "Alerte désactivée.", "дымовой датчик", "Detector de humo desactivado.", "جهاز استشعار الدخان الانذار الافراج"];
	var arr_26 = ["(Device name->Smoke sensor name)alarm has been lifted ", "(设备名称->烟雾传感器名称)告警解除", "(Nom du périphérique->Nom)Se produire", "(Название устройства - > Название датчика дыма)", "(nombre del dispositivo - > nombre del sensor de humo)", "(اسم الجهاز -> اسم جهاز استشعار الدخان)"];
	var arr_27 = ["Water snesor alarming lifted", "水浸传感器告警解除", "Alerte désactivée.", "(Название устройства - > Название датчика) вновь закрыто", "датчик погружения", "Sensores de inmersión desactivados.", "إطلاق جهاز استشعار الفيضان"];
	var arr_28 = ["(Device name->water sensor name)alarm has been lifted ", "(设备名称->断路器名称)告警解除", "(Nom du périphérique->Nom)Se produire", "(Название устройства - > название прерывателя)", "(nombre del dispositivo - > nombre del interruptor)", "(اسم الجهاز -> اسم الكسارة) إصدار إنذار"];
	var arr_29 = ["breaker alarming lifted", "断路器告警解除", "Alerte désactivée.", "отключение сигнализации", "El interruptor está desactivado.", "إطلاق إنذار الكسارة الدائرة"];
	var arr_30 = ["(Device name->breaker name)alarm has been lifted ", "(设备名称->断路器名称)告警解除", "(Nom du périphérique->Nom)Se produire", "(Название устройства - > название прерывателя)", "(nombre del dispositivo - > nombre del interruptor)", "(اسم الجهاز -> اسم الكسارة) إصدار إنذار"];
	var arr_31 = ["Device restart ", "设备重启","Redémarrage de l'appareil", "Перезапуск устройства", "Reinicio del dispositivo", "إعادة تشغيل الجهاز"];

	var arr_32 = ["Leakage current alarm ", "漏电电流告警","Redémarrage de l'appareil", "Перезапуск устройства", "Reinicio del dispositivo", "إعادة تشغيل الجهاز"];
	var arr_33 = ["The data collected by the execution board is abnormal ", "执行板采集数据异常","Redémarrage de l'appareil", "Перезапуск устройства", "Reinicio del dispositivo", "إعادة تشغيل الجهاز"];
	var arr_34 = ["The output voltage is unstable ", "输出位电压不稳定","Tension de sortie instable", "Выходное напряжение нестабильно", "Voltaje inestable de los bits de salida", "مستوى المخرج غير مستقر!"];

	$.ajax({
		dataType:"text",
		url:"/alarmlog?id1="+pg,
		async:true,
		cache:false,
		success:function(sta)
		{
			if(sta=="err1")
			{
				for(var i=0;i<24;i++)
				{
					document.getElementById("tr"+i).style.display="none";
				}
				alert(arr_22[flag]);
				return;
			}
			var gv = new Array();
			gv=sta.split("?");
			var k=0;
			document.getElementById("tpg").innerHTML=gv[0];
			document.getElementById("size").innerHTML=gv[0];
			for(var i=0;i<24;i++)
			{
				if(gv[i*4+1])
				{
					if(k%2!=0)
						document.getElementById("tr"+i).style.background="#f0f0f0";
					else
						document.getElementById("tr"+i).style.background="#ffffff";
					k++;
				
					document.getElementById("tr"+i).style.display="";
					document.getElementById("a"+i).innerHTML=(parseInt(pg)-1)*24+i+1;	//序号
					document.getElementById("b"+i).innerHTML=gv[i*4+1];					//时间
				
					type = [[" warning ", " alarm ", "warning lifted ", "alarm lifted "], ["预警", "告警", "预警解除", "告警解除"], [" Avertissement ", " Alerte ", "Désactivation de l 'avertissement ", "Alerte désactivée. "], ["раннее предупреждение", "предупреждать", "отменить раннее предупреждение", "отбой тревоги"], ["Alerta", "Alarma", "Alerta desactivada.", "Advertencia despejada."], []];
				//	alert(gv[i*4+1]+"  "+gv[i*4+2]+"  "+gv[i*4+3]+"  "+gv[i*4+4]);
					var abc = new Array();
					abc=gv[i*4+2].split("-");
					if(abc[1]==1)	//预警
					{
						document.getElementById("c"+i).innerHTML=type[flag][0];
					}
					else if(abc[1]==2)	//告警
					{
						document.getElementById("c"+i).innerHTML=type[flag][1];
					}
					else if(abc[1]==3)	//预警解除
					{
						document.getElementById("c"+i).innerHTML=type[flag][2];
					}
					else if(abc[1]==4)	//告警解除
					{
						document.getElementById("c"+i).innerHTML=type[flag][3];
					}
					
					if(abc[1]==1 || abc[1]==2)
					{
						if(abc[0]==0)
						{
							document.getElementById("d"+i).innerHTML=arr_1[flag]+type[flag][abc[1]-1];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_2[flag]+type[flag][abc[1]-1]+arr_3[flag]+gv[i*4+4]+"A";
						}
						else if(abc[0]==1)
						{
							document.getElementById("d"+i).innerHTML=arr_4[flag]+type[flag][abc[1]-1];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_5[flag]+type[flag][abc[1]-1]+arr_3[flag]+gv[i*4+4]+"A";
						}

						else if(abc[0]==2)
						{
							document.getElementById("d"+i).innerHTML=arr_66[flag]+type[flag][abc[1]-1];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_77[flag]+type[flag][abc[1]-1]+arr_3[flag]+gv[i*4+4]+"A";
						}
						else if(abc[0]==3)
						{
							document.getElementById("d"+i).innerHTML=arr_6[flag]+type[flag][abc[1]-1];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_7[flag]+type[flag][abc[1]-1]+arr_3[flag]+gv[i*4+4]+"A";
						}
						else if(abc[0]==4)
						{
							document.getElementById("d"+i).innerHTML=arr_8[flag]+type[flag][abc[1]-1];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_9[flag]+type[flag][abc[1]-1]+arr_3[flag]+gv[i*4+4]+"V";
						}
						else if(abc[0]==5)
						{
							document.getElementById("d"+i).innerHTML=arr_10[flag]+type[flag][abc[1]-1];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_11[flag]+type[flag][abc[1]-1]+arr_3[flag]+gv[i*4+4]+"℃";
						}
						else if(abc[0]==6)
						{
							document.getElementById("d"+i).innerHTML=arr_12[flag]+type[flag][abc[1]-1];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_13[flag]+type[flag][abc[1]-1]+arr_3[flag]+gv[i*4+4]+"%";
						}
						else if(abc[0]==7)//
						{
							document.getElementById("d"+i).innerHTML=arr_14[flag];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_15[flag];
						}
						else if(abc[0]==8)
						{
							document.getElementById("d"+i).innerHTML=arr_16[flag];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_17[flag];
						}
						else if(abc[0]==9)
						{
							document.getElementById("d"+i).innerHTML=arr_18[flag];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_19[flag];
						}
						else if(abc[0]==10)
						{
							document.getElementById("d"+i).innerHTML=arr_20[flag];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_21[flag];
						}
						else if(abc[0]==11)
						{
							document.getElementById("d"+i).innerHTML=arr_31[flag];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_31[flag];
						}

						
						else if(abc[0]==20)
						{
							document.getElementById("d"+i).innerHTML=arr_32[flag];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_33[flag];
						}
						else if(abc[0]==21)
						{
							document.getElementById("d"+i).innerHTML=arr_33[flag];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_33[flag];
						}
						else if(abc[0]==22)
						{
							document.getElementById("d"+i).innerHTML=arr_34[flag];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_34[flag];
						}
					}
					else
					{
						if(abc[0]==0)
						{
							document.getElementById("d"+i).innerHTML=arr_1[flag]+type[flag][abc[1]-1];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_2[flag]+type[flag][abc[1]-1]+arr_3[flag]+gv[i*4+4]+"A";
						}
						else if(abc[0]==1)
						{
							document.getElementById("d"+i).innerHTML=arr_4[flag]+type[flag][abc[1]-1];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_5[flag]+type[flag][abc[1]-1]+arr_3[flag]+gv[i*4+4]+"A";
						}

						else if(abc[0]==2)
						{
							document.getElementById("d"+i).innerHTML=arr_66[flag]+type[flag][abc[1]-1];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_77[flag]+type[flag][abc[1]-1]+arr_3[flag]+gv[i*4+4]+"A";
						}
						else if(abc[0]==3)
						{
							document.getElementById("d"+i).innerHTML=arr_6[flag]+type[flag][abc[1]-1];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_7[flag]+type[flag][abc[1]-1]+arr_3[flag]+gv[i*4+4]+"A";
						}
						else if(abc[0]==4)
						{
							document.getElementById("d"+i).innerHTML=arr_8[flag]+type[flag][abc[1]-1];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_9[flag]+type[flag][abc[1]-1]+arr_3[flag]+gv[i*4+4]+"V";
						}
						else if(abc[0]==5)
						{
							document.getElementById("d"+i).innerHTML=arr_10[flag]+type[flag][abc[1]-1];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_11[flag]+type[flag][abc[1]-1]+arr_3[flag]+gv[i*4+4]+"℃";
						}
						else if(abc[0]==6)
						{
							document.getElementById("d"+i).innerHTML=arr_12[flag]+type[flag][abc[1]-1];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_13[flag]+type[flag][abc[1]-1]+arr_3[flag]+gv[i*4+4]+"%";
						}
						else if(abc[0]==7)//
						{
							document.getElementById("d"+i).innerHTML=arr_23[flag];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_24[flag];
						}
						else if(abc[0]==8)
						{
							document.getElementById("d"+i).innerHTML=arr_25[flag];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_26[flag];
						}
						else if(abc[0]==9)
						{
							document.getElementById("d"+i).innerHTML=arr_27[flag];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_28[flag];
						}
						else if(abc[0]==10)
						{
							document.getElementById("d"+i).innerHTML=arr_29[flag];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_30[flag];
						}
						else if(abc[0]==11)
						{
							document.getElementById("d"+i).innerHTML=arr_31[flag];
							document.getElementById("e"+i).innerHTML=gv[i*4+3]+arr_31[flag];
						}
					}
				}
				else
				{
					document.getElementById("tr"+i).style.display="none";
				}
			}
		}
	});
		
}
function clearlogs()
{
	if(flag==0)
	{
		if(confirm("Are you sure to delete log records?"))
		{
			$.ajax({
				dataType:"text",
				url:"/clearalarmlogs",
				async:true,
				cache:false,
				success:function(sta)
				{
					if(sta=="OK")
					{
						alert("Log records are successfully deleted.");
						window.location.reload();	
					}
					else if(sta=="flase")
					{
						alert("No permission!");
					}
				}
			});
		}
	}
	else
	{
		if(confirm("你确定要删除日志记录?"))
		{
			$.ajax({
				dataType:"text",
				url:"/clearalarmlogs",
				async:true,
				cache:false,
				success:function(sta)
				{
					if(sta=="OK")
					{
						alert("成功删除日志记录.");
						window.location.reload();	
					}
					else if(sta=="flase")
					{
						alert("无权限!");
					}
				}
			});
		}
	}
}



//打印表格
var idTmr;

function getExplorer()
{
    var explorer = window.navigator.userAgent;
	if(IEVersion()>=6||IEVersion()=='edge')
	{
		return 'ie';
	}
	else
	{
		//ie
		//if (explorer.indexOf("MSIE") >= 0)
		//{
		//	return 'ie';
		//}
		//firefox
		if (explorer.indexOf("Firefox") >= 0)
		{
			return 'Firefox';
		}
		//Chrome
		else if (explorer.indexOf("Chrome") >= 0)
		{
			return 'Chrome';
		}
		//Opera
		else if (explorer.indexOf("Opera") >= 0)
		{
			return 'Opera';
		}
		//Safari
		else if (explorer.indexOf("Safari") >= 0)
		{
			return 'Safari';
		}		
	}
}
function IEVersion() {
            var userAgent = navigator.userAgent; //取得浏览器的userAgent字符串  
            var isIE = userAgent.indexOf("compatible") > -1 && userAgent.indexOf("MSIE") > -1; //判断是否IE<11浏览器  
            var isEdge = userAgent.indexOf("Edge") > -1 && !isIE; //判断是否IE的Edge浏览器  
            var isIE11 = userAgent.indexOf('Trident') > -1 && userAgent.indexOf("rv:11.0") > -1;
            if(isIE) {
                var reIE = new RegExp("MSIE (\\d+\\.\\d+);");
                reIE.test(userAgent);
                var fIEVersion = parseFloat(RegExp["$1"]);
                if(fIEVersion == 7) {
                    return 7;
                } else if(fIEVersion == 8) {
                    return 8;
                } else if(fIEVersion == 9) {
                    return 9;
                } else if(fIEVersion == 10) {
                    return 10;
                } else {
                    return 6;//IE版本<=7
                }   
            } else if(isEdge) {
                return 'edge';//edge
            } else if(isIE11) {
                return 11; //IE11  
            }else{
                return -1;//不是ie浏览器
            }
}
function method5(tableid) {
	if (getExplorer() == 'ie')
	{		  
		  try {
				var oXL = new ActiveXObject("Excel.Application"); 
				}catch(e) 
				{
					if(flag==0)
					{
						alert( "The installation of EXCEL is required to export the table. And the use of 'ACTIVEX CONTROLS' is also required for browsing the table. In IE safety settings choose 'Initialize and script Activex controls not marked as safe' option.");
					}
					else
					{
						alert( "要导出该表，您必须安装Excel电子表格软件，同时浏览器须使用“ActiveX 控件”，在IE的安全设置里启用“对未标记为可安全执行脚本的ActiveX控件初始化并执行脚本”项。");
					}
					return "";
				}
		
		
			var curTbl = document.getElementById(tableid); 	
			var oWB = oXL.Workbooks.Add(); 
			var oSheet = oWB.ActiveSheet; 
			var Lenr = curTbl.rows.length; 
			for (i = 0; i < Lenr; i++) 
			{ 
				var Lenc = curTbl.rows(i).cells.length; 
				for (j = 0; j < Lenc; j++) 
				{ 
					oSheet.Cells(i + 1, j + 1).value = curTbl.rows(i).cells(j).innerText; 
				 } 
			} 
			oXL.Visible = true; 	  		
	} 
	else
	{
		tableToExcel(tableid)
	}
}
function Cleanup() {
	window.clearInterval(idTmr);
	CollectGarbage();
}
var tableToExcel = (function() {
	var uri = 'data:application/vnd.ms-excel;base64,',
		template = '<html><head><meta charset="UTF-8"></head><body><table  border="1">{table}</table></body></html>',
		base64 = function(
			s) {
			return window.btoa(unescape(encodeURIComponent(s)))
		},
		format = function(s, c) {
			return s.replace(/{(\w+)}/g, function(m, p) {
				return c[p];
			})
		}
	return function(table, name) {
		if(!table.nodeType)
			table = document.getElementById(table)
		var ctx = {
			worksheet: name || 'Worksheet',
			table: table.innerHTML
		}
	//	window.location.href = uri + base64(format(template, ctx))
		
		document.getElementById("dlink").href = uri + base64(format(template, ctx));
		document.getElementById("dlink").download = 'alarmlog.xls';//这里是关键所在,当点击之后,设置a标签的属性,这样就可以更改标签的标题了
		document.getElementById("dlink").click();
	}
})()


</script>
</head>
<body>
<div style="padding: 0px; margin-bottom: 0.8%; overflow: hidden; ">
	<div class="box" style="float: left; width: 100%; margin-bottom: 0.8%; height:96%; background:#e7e7e7;">
		<div class="panel panel-default">
			<div class="panel-heading" ><i class="fa fa-area-chart fa-lg" style="padding-right: 5px;" ></i ><span id="lang_1"></span></div>			
		</div>
		<div style="border:1px solid;border-color: #ffffff; margin:10px; height:775px; background:#ffffff;">

			<table border="0" id="dataTable" width="100%" style="font-size:12px; text-align:center;">
				<tr align="left" style="color:#000000;background:#e7e7e7; height:30px; text-align:center">
					<td width="4% "><b id="lang_2"></b></td>
					<td width="10%"><b id="lang_3"></b></td>
					<td width="10%"><b id="lang_4"></b></td>
					<td width="10%"><b id="lang_5"></b></td>
					<td width="66%"><b id="lang_6"></b></td>
				</tr>
				<tr id="tr0" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a0" align="center"></td>
					<td id="b0"></td>
					<td id="c0"></td>
					<td id="d0"></td>
					<td id="e0"></td>
				</tr>
				<tr id="tr1" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a1" align="center"></td>
					<td id="b1"></td>
					<td id="c1"></td>
					<td id="d1"></td>
					<td id="e1"></td>
				</tr>
				<tr id="tr2" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a2" align="center"></td>
					<td id="b2"></td>
					<td id="c2"></td>
					<td id="d2"></td>
					<td id="e2"></td>
				</tr>
				<tr id="tr3" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a3" align="center"></td>
					<td id="b3"></td>
					<td id="c3"></td>
					<td id="d3"></td>
					<td id="e3"></td>
				</tr>
				<tr id="tr4" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a4" align="center"></td>
					<td id="b4"></td>
					<td id="c4"></td>
					<td id="d4"></td>
					<td id="e4"></td>
				</tr>
				<tr id="tr5" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a5" align="center"></td>
					<td id="b5"></td>
					<td id="c5"></td>
					<td id="d5"></td>
					<td id="e5"></td>
				</tr>
				<tr id="tr6" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a6" align="center"></td>
					<td id="b6"></td>
					<td id="c6"></td>
					<td id="d6"></td>
					<td id="e6"></td>
				</tr>
				<tr id="tr7" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a7" align="center"></td>
					<td id="b7"></td>
					<td id="c7"></td>
					<td id="d7"></td>
					<td id="e7"></td>
				</tr>
				<tr id="tr8" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a8" align="center"></td>
					<td id="b8"></td>
					<td id="c8"></td>
					<td id="d8"></td>
					<td id="e8"></td>
				</tr>
				<tr id="tr9" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a9" align="center"></td>
					<td id="b9"></td>
					<td id="c9"></td>
					<td id="d9"></td>
					<td id="e9"></td>
				</tr>
				<tr id="tr10" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a10" align="center"></td>
					<td id="b10"></td>
					<td id="c10"></td>
					<td id="d10"></td>
					<td id="e10"></td>
				</tr>
				<tr id="tr11" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a11" align="center"></td>
					<td id="b11"></td>
					<td id="c11"></td>
					<td id="d11"></td>
					<td id="e11"></td>
				</tr>
				<tr id="tr12" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a12" align="center"></td>
					<td id="b12"></td>
					<td id="c12"></td>
					<td id="d12"></td>
					<td id="e12"></td>
				</tr>
				<tr id="tr13" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a13" align="center"></td>
					<td id="b13"></td>
					<td id="c13"></td>
					<td id="d13"></td>
					<td id="e13"></td>
				</tr>
				<tr id="tr14" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a14" align="center"></td>
					<td id="b14"></td>
					<td id="c14"></td>
					<td id="d14"></td>
					<td id="e14"></td>
				</tr>
				<tr id="tr15" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a15" align="center"></td>
					<td id="b15"></td>
					<td id="c15"></td>
					<td id="d15"></td>
					<td id="e15"></td>
				</tr>
				<tr id="tr16" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a16" align="center"></td>
					<td id="b16"></td>
					<td id="c16"></td>
					<td id="d16"></td>
					<td id="e16"></td>
				</tr>
				<tr id="tr17" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a17" align="center"></td>
					<td id="b17"></td>
					<td id="c17"></td>
					<td id="d17"></td>
					<td id="e17"></td>
				</tr>
				<tr id="tr18" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a18" align="center"></td>
					<td id="b18"></td>
					<td id="c18"></td>
					<td id="d18"></td>
					<td id="e18"></td>
				</tr>
				<tr id="tr19" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a19" align="center"></td>
					<td id="b19"></td>
					<td id="c19"></td>
					<td id="d19"></td>
					<td id="e19"></td>
				</tr>
				<tr id="tr20" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a20" align="center"></td>
					<td id="b20"></td>
					<td id="c20"></td>
					<td id="d20"></td>
					<td id="e20"></td>
				</tr>
				<tr id="tr21" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a21" align="center"></td>
					<td id="b21"></td>
					<td id="c21"></td>
					<td id="d21"></td>
					<td id="e21"></td>
				</tr>
				<tr id="tr22" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a22" align="center"></td>
					<td id="b22"></td>
					<td id="c22"></td>
					<td id="d22"></td>
					<td id="e22"></td>
				</tr>
				<tr id="tr23" onMouseOut="movout(this);" onMouseMove="mov(this);">
					<td id="a23" align="center"></td>
					<td id="b23"></td>
					<td id="c23"></td>
					<td id="d23"></td>
					<td id="e23"></td>
				</tr>
				<tr style="height:50px; white-space:nowrap;">
					<td colspan="4"></td>
					<td style="text-align:right;">
						<b id="lang_7"></b><b id="size"></b><b>KB</b>&nbsp;&nbsp;
						<b id="lang_8"></b>&nbsp;<b><input id="pg" style="width:50px;"></input></b>&nbsp;<b id="lang_9"></b>&nbsp;<b id="tpg"></b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						<input id="lang_10" style="position:relative; height:21px; width:90px; margin-right:2%;" type="button" onClick="gotopage();"></input>
						<input id="lang_11" style="position:relative; height:21px; width:90px; margin-right:2%;" type="button" onClick="front();"></input>
						<input id="lang_12" style="position:relative; height:21px; width:90px; margin-right:2%;" type="button" onClick="next();"></input>
						<input id="lang_13" style="position:relative; height:21px; width:90px; margin-right:2%;" type="button" onClick="clearlogs();"></input>
						<a id="dlink"  style="display:none;"></a>
						<input id="lang_14" style="position:relative; height:21px; width:90px; margin-right:5%;" type="button" id="excell" onclick="method5('dataTable');"></input>
					</td>
				</tr>
				
			</table>
		</div>
    </div>   
</div>
</body>
</html>

