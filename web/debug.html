<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="ie=edge,chrome=1">
		<meta name="renderer" content="webkit">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>debug</title>
		<link rel="stylesheet" href="./include/css/public.min.css">
		<link rel="stylesheet" href="./include/css/iconfont.min.css">
		<link rel="stylesheet" href="./include/css/font-awesome.min.css">
		<style>
			.panel-default{
            border: none;
            border-radius: 0px;
            margin-bottom: 0px;
            box-shadow: none;
            -webkit-box-shadow: none;
			}
			.panel-default > .panel-heading{
				color: #222;
				font-size:13px;
				background-color: #fff;
				border-color: #e6e6e6;
				padding: 10px 12px;
			}
		</style>
	</head>
<body>
	<div class="page-cont">
		<div class="section">
			<div class="section-cont">
				<div class="grid-row">
					<div class="grid-col grid-col-7">
						<div class = "panel panel-default">
							<div class ="panel-heading">
								<i class = "fa fa-th-list fa-lg " style="padding-right:5px;"></i>
								<span id="lang_1">后台管理设置</span>
				
							</div>
						</div>
					</div>
					<div>
						<input  id = "inputkey" type = "file" style ="display: none;" onchange="chosefile()">
						<button type ="button" onclick = "document.getElementById('inputkey').click()">选择logo</button> 
						<input type = "text" value = "" id = "info" >
						<label id  = "loading"></label><button  id = "" onclick = 'upload_data()'>上传logo</button>
					</div>
					<div class="grid-col grid-col-7 ">
						<table class="table table-border-none_ text-left_ set_table"></table>
					</div>
					<div class="grid-col grid-col-7">
						<table class="table table-border-none_ text-left_ threshold_table"></table>
					</div>
					<div class="grid-col grid-col-7">
						<table class="table table-border-none_ text-left_ out_table"></table>
					</div>
					<div class="grid-col grid-col-7">
						<table class="table table-border-none_ text-center vol_table"></table>
					</div>
					<div style=" width: 99%; margin-bottom: 0.8%; border:1px solid;border-color: #ffffff; margin-left:10px; height:100px; background:#ffffff;">
					</div>
				</div>
			</div>
		</div>
    <script src="./include/js/jquery-1.11.3.min.js"></script>
	<script src="../../include/js/pdu_rpc.js"></script>
    <script src="./include/js/fn_public.js"></script>
    <script src="./include/js/public.min.js"></script>
    <script>
		//var pdu_metadata_ = new PduMetaData();
		//https重定向到http
		var target_protocol = "http:";
		if(window.location.protocol != target_protocol){
			window.location.href = target_protocol +
			window.location.href.substring(window.location.protocol.length);
		}

		let pdu_obj = PduCore.build();
		setTimeout(function(){
			pdu_obj.debugCfg();
			PduMetaData.meta_workDown(0);
		},200);
    	let name_phase_ = new Array("单相","双火线","三相");
    	let id_name = new Array("phase_","board_num_","board_num1","board_num2","board_num3","board_num4","");
		let num_id = new Array("","phase_","loop_","","board_");
    	let distribution = new Array("6x8","4x12","8x6","12x4");
		let phase = 1,loop = 2,output =3,envir = 6,num = 12,cfg = 13;
		let vol_ = 2,cur_ = 3,pow_ = 4,tmp_=11,hum_ = 12;
		let addr = 0;
		let output_num = "";
		let phase_num= "";
		let loop_num= "";
		let board_num= "";
		var mark = 1;
		let pdu_data= "";
		let board_out = new Array(0,0,0,0);
		let loop_out = new Array(0,0,0,0,0,0);
		let cfg_data = new Array(10);
		let break_en = 0;
		let rating = new Array();
		let rating_ = new Array();;
		let out_vol = new Array(49);
		let unite_data = new Array();
		let unite_name = new Array(phase,phase,phase,loop,loop,loop,output,envir,envir,output);
		let unite_type = new Array(vol_,cur_,pow_,vol_,cur_,pow_,cur_,tmp_,hum_,pow_);
		let unite_id = new Array("phase_vol_","phase_cur_","phase_pow_","loop_vol_","loop_cur_","loop_pow_","output_cur_","envir_tmp_","envir_hum_","out_put_pow_");
		let name_cfg_ = new Array("angle_","ver_mode_","dev_type_","serson_box_","ser_sel_","language_","mac_");
		let unite_sub = new Array(2,5,6,7,4);
		for(i = 1;i<49;i++){
			out_vol[i] = 0;
		}
		$('.set_table').html(buildTable());
		$('.threshold_table').html(buildTableThreshold());
		$('.out_table').html(buildTableOutput());
		$('.vol_table').html(buildTableVol());ase_info_ = new Array();
		let output_info_ = new Array();
		function ParseData(){
			let DataString = pdu_obj.meta_value();
			pdu_data = JSON.parse(DataString);
			if(pdu_data == null){
				return;
			}

			//phase_num = pdu_obj.meta_Json_value(pdu_info, line_num);

			phase_num = pdu_data.pdu_info.line_num;
			loop_num = pdu_data.pdu_info.loop_num;
			output_num = pdu_data.pdu_info.output_num;
			board_num = pdu_data.pdu_info.board_num;
			language = pdu_data.pdu_info.language;

			let k = 0;
			if(mark){
				pdu_obj.debugVolData(output_num);
				mark = 0;
			}
			for(let i = 0;i<output_num;i++){
				output_info_[i] = new Array();
				let j = 0;
				for(let key in pdu_data.pdu_data.output_item_list){
					output_info_[i][j] = pdu_data.pdu_data.output_item_list[key][i];
					j ++;
				}
			}
			for(i= 0;i<board_num;i++){
				board_out[i] =  pdu_data.pdu_info.ops_num[i];
			}
			for(i= 0;i<loop_num;i++){
				loop_out[i] = pdu_data.pdu_info.loop_array[i];
			}
			for(i= 0;i<10;i++){
				cfg_data[i] = "";
			}
			cfg_data[6] = pdu_data.net_addr.mac;
			break_en = pdu_obj.cfgValue(cfg,11,0,addr);
			cfg_data[0] = pdu_obj.cfgValue(cfg,13,0,addr);
			cfg_data[1] = pdu_data.pdu_info.stand_neutral;
			cfg_data[2] = pdu_data.uut_info.pdu_type;
			//cfg_data[2] = pdu_obj.cfgValue(11,6,0,addr);
			cfg_data[3] = pdu_obj.cfgValue(cfg,9,0,addr);
			cfg_data[4] = pdu_obj.cfgValue(cfg,1,0,addr);
			cfg_data[5] = pdu_obj.cfgValue(cfg,10,0,addr);
			for(let i = 0;i<10;i++){
				unite_data[i] = new Array();
				unite_data[i][0] = pdu_obj.getValue(unite_name[i],unite_type[i],2,0);
				unite_data[i][1] = pdu_obj.getValue(unite_name[i],unite_type[i],5,0);
				unite_data[i][2] = pdu_obj.getValue(unite_name[i],unite_type[i],6,0);
				unite_data[i][3] = pdu_obj.getValue(unite_name[i],unite_type[i],7,0);
				unite_data[i][4] = pdu_obj.getValue(unite_name[i],unite_type[i],4,0);
			}
			for(i =1;i<=output_num;i++){
				rating[i] = output_info_[i -1][6];
				out_vol[i] = pdu_obj.getValue(output,vol_,1,i);
				rating_[i] = rating[i];
			}
		}
		let m = 0;
		var Time1 = setInterval(function(){
			ParseData();
			if(m>=20 || unite_data[9][4] !=null){
				clearInterval(Time1);
				ShowData();
			}
			m++;
		},1100);
		let ph
		function ShowData(){
			document.getElementById("phase_").value = phase_num;
			document.getElementById("loop_").value = loop_num;
			document.getElementById("board_").value = board_num;
			for(let i = 1;i < loop_num+1;i++){
				document.getElementById("out_num"+i).value = loop_out[i - 1];
			}
			for(let i = 1;i < board_num+1;i++){
				document.getElementById("board_num"+i).value = board_out[i - 1];
			}
			document.getElementById("break_").value = break_en;
			for(i =0;i<7;i++){
				document.getElementById(name_cfg_[i]).value = cfg_data[i];
			}
			for(let i = 0;i<10;i++){
				for(let j = 0;j<5;j++){
					if( unite_data[i][j] != null){
						document.getElementById(unite_id[i]+j).value = unite_data[i][j];
					}
				}
			}
			for(i =1;i<=output_num;i++){
				if(rating[i] == 16){
					document.getElementById("a"+i).checked = true;
				}else if(rating[i] == 10){
					document.getElementById("b"+i).checked = true;
				}else{

				}
			}
		}
		function Set_(){
			setTimeout(() => {
				PduMetaData.meta_workDown();
			}, 100);
			for(let i = 0;i<num_id.length;i ++){
				if(num_id[i] != ""){
					pdu_obj.setCfg(num,i,document.getElementById(num_id[i]).value,0,addr);
				}
			}
			for(let i = 1;i < loop_num+1;i++){
				pdu_obj.setCfg(num,7,document.getElementById("out_num"+i).value,(i -1),addr);
			}
			for(let i = 1;i < board_num+1;i++){
				pdu_obj.setCfg(num,6,document.getElementById("board_num"+i).value,(i -1),addr);
			}
			pdu_obj.setCfg(cfg,17,document.getElementById("ver_mode_").value,addr);
			pdu_obj.setCfg(11,6,document.getElementById("dev_type_").value,0,addr);
			pdu_obj.setCfg(cfg,11,document.getElementById("break_").value,0,addr);
			pdu_obj.setCfg(cfg,13,document.getElementById("angle_").value,0,addr);
			pdu_obj.setCfg(cfg,1,document.getElementById("ser_sel_").value,0,addr);
			pdu_obj.setCfg(cfg,10,document.getElementById("language_").value,0,addr);
			pdu_obj.setCfg(cfg,9,document.getElementById("serson_box_").value,0,addr);
			pdu_obj.setCfg(41,11,document.getElementById("mac_").value,0,addr);
			setTimeout(() => {
				PduMetaData.meta_workDown();
				pdu_obj.debugCfg();
			}, 100);
		}
		function AllSet(){
			for(let i = 0;i<10;i++){
				for(let j = 0;j<5;j++){
					if(document.getElementById(unite_id[i]+j).value == unite_data[i][j]){
					}else{
						pdu_obj.setData(unite_name[i],unite_type[i],unite_sub[j],0,document.getElementById(unite_id[i]+j).value);
					}
				}
			}
			setTimeout(() => {
				PduMetaData.meta_workDown();
				pdu_obj.debugCfg();
			}, 100);
		}
		function cked(ckd){
			var stat=0,type_ = 0;
			let addr = 0;
			var type1 = ckd.id.substr(0,1);
			var num = parseInt(ckd.id.slice(1));
			type_ = type1.charCodeAt() - 'a'.charCodeAt();
			if(ckd.checked == false){
				ckd.checked = true;
				return ;
			}
			if(num <= output_num){
				if(type_==0){
					stat = '16';
					document.getElementById("b" + num).checked = false;
					document.getElementById("c" + num).checked = false;
				}else if(type_ == 1){
					stat = '10';
					document.getElementById("a" + num).checked = false;
					document.getElementById("c" + num).checked = false;
				}else{
					stat = document.getElementById("cur_val").value;
					document.getElementById("a" + num).checked = false;
					document.getElementById("b" + num).checked = false;
				}
			}else{
				ckd.checked = false;
			}
			rating_[num] = stat;
		}
		var setStatus = function(text,id,ok) {
			document.getElementById(id).innerText = text;
			if(ok){
				document.getElementById(id).style.color = 'green';
			}else{
				document.getElementById(id).style.color = 'red';
			}
				
		};
		var sendFileData = function(name, data, chunkSize,id){
			var sendChunk = function(offset) {
				var chunk = data.subarray(offset, offset + chunkSize) || '';
				var opts = {method: 'POST', body: chunk};
				var url = '/upload_logo?offset=' + offset + '&name=' + encodeURIComponent(name);
				var ok = true;
				setStatus(
					'Uploading ' + name + ', bytes ' + offset + '..' +
					(offset + chunk.length) + ' of ' + data.length,id,ok);
				fetch(url, opts)
					.then(function(res) {
					if (res.ok && chunk.length > 0) sendChunk(offset + chunk.length);
					ok = res.ok;
					return res.text();
					})
					.then(function(text) {
					if (!ok) setStatus('Error: ' + text,id,ok);
					});
			};
			sendChunk(0);
		};
		function upload_data(){
			let  key = document.getElementById("info").value;
			if(key != ""){
				let fileObj = document.getElementById('inputkey').files[0];
				if (!fileObj) return;
				var f = fileObj, r = new FileReader();
				r.readAsArrayBuffer(f);
				r.onload = function() {
					sendFileData(f.name, new Uint8Array(r.result), 2048,"loading");
				};
			}
		}
		function chosefile(){
			document.getElementById("info").value = document.getElementById("inputkey").value;
		}
		function Set(){
			for(let  i = 1;i<=output_num;i++){
				pdu_obj.setData(output,cur_,2,i,rating_[i]);
			}
			setTimeout(() => {
				PduMetaData.meta_workDown();
			}, 100);
		}
		setInterval(function(){
			pdu_obj.debugVolData(output_num);
			setTimeout(function(){
				for(i =1;i<=output_num;i++){
					out_vol[i] = pdu_obj.getValue(output,vol_,1,i);
					document.getElementById("vol" + i).innerHTML = out_vol[i];
				}
			},500);
		},2000);

	
		function power_calculation(){
			/*power calculation*/
			document.getElementById("phase_pow_"+0).value =parseFloat((parseInt(document.getElementById("phase_vol_"+0).value) * parseFloat(document.getElementById("phase_cur_"+0).value))/1000).toFixed(3);
			document.getElementById("phase_pow_"+3).value =parseFloat(parseFloat(document.getElementById("phase_pow_"+0).value)*0.8).toFixed(3);
			document.getElementById("phase_pow_"+4).value =document.getElementById("phase_pow_"+0).value;

			document.getElementById("loop_pow_"+0).value =parseFloat((parseInt(document.getElementById("loop_vol_"+0).value) * parseFloat(document.getElementById("loop_cur_"+0).value))/1000).toFixed(3);
			document.getElementById("loop_pow_"+3).value =parseFloat(parseFloat(document.getElementById("loop_pow_"+0).value)*0.8).toFixed(3);
			document.getElementById("loop_pow_"+4).value =document.getElementById("loop_pow_"+0).value;

			document.getElementById("out_put_pow_"+0).value =parseFloat((parseInt(document.getElementById("loop_vol_"+0).value) * parseFloat(document.getElementById("output_cur_"+0).value))/1000).toFixed(3);
			document.getElementById("out_put_pow_"+3).value =parseFloat(parseFloat(document.getElementById("out_put_pow_"+0).value)*0.8).toFixed(3);
			document.getElementById("out_put_pow_"+4).value =document.getElementById("out_put_pow_"+0).value;

			/*current calculation*/
			document.getElementById("phase_cur_"+3).value =parseFloat(parseFloat(document.getElementById("phase_cur_"+0).value)*0.8).toFixed(2);
			document.getElementById("phase_cur_"+4).value =document.getElementById("phase_cur_"+0).value;

			document.getElementById("loop_cur_"+3).value =parseFloat(parseFloat(document.getElementById("loop_cur_"+0).value)*0.8).toFixed(2);
			document.getElementById("loop_cur_"+4).value =document.getElementById("loop_cur_"+0).value;

			document.getElementById("output_cur_"+3).value =parseFloat(parseFloat(document.getElementById("output_cur_"+0).value)*0.8).toFixed(2);
			document.getElementById("output_cur_"+4).value =document.getElementById("output_cur_"+0).value;

			/*voltage calculation*/
		/*	document.getElementById("phase_vol_"+3).value =parseFloat(parseFloat(document.getElementById("phase_vol_"+0).value)*0.8).toFixed(2);
			document.getElementById("phase_vol_"+4).value =document.getElementById("phase_vol_"+0).value;

			document.getElementById("loop_vol_"+3).value =parseFloat(parseFloat(document.getElementById("loop_vol_"+0).value)*0.8).toFixed(2);
			document.getElementById("loop_vol_"+4).value =document.getElementById("loop_vol_"+0).value;
		*/
			AllSet();
		}


		function buildTable() {
			var thead = '',tbody = '';
			thead = '<tr><td width ="25%" style="font-size:20px;">设置</td>\
			<td width ="75%"></td></tr>';
			tbody += '<tr><td>相位数:</td>';
			tbody += '<td><input id = "phase_" style ="width:2.5%" type = "text" onchange = "Set_()"  oninput = "if(value>3){value=3} if(value<3){value=1}"value="'+phase_num+'"></input>(1-单相,3-三相)</td></tr>';
			tbody += '<tr><td>执行板数量:</td>';
			tbody += '<td><input id = "board_" style ="width:2.5%" type = "text" onchange = "Set_()" oninput = "if(value>4){value=4}"value="'+board_num+'"></input></td></tr>';
			tbody += '<tr><td>每块执行板的输出位数量:</td>';
			tbody += '<td><input id = "board_num1" style ="width:2.5%" type = "text" onchange = "Set_()" value="'+board_out[0]+'"></input>';
			tbody += '&nbsp&nbsp<input id = "board_num2" style ="width:2.5%;" type = "text" onchange = "Set_()" value="'+board_out[1]+'"></input>';
			tbody += '&nbsp&nbsp<input id = "board_num3" style ="width:2.5%;" type = "text" onchange = "Set_()" value="'+board_out[2]+'"></input>';
			tbody += '&nbsp&nbsp<input id = "board_num4" style ="width:2.5%;" type = "text" onchange = "Set_()" value="'+board_out[3]+'"></input></td></tr>';
			tbody += '<tr><td>回路数量:</td>';
			tbody += '<td><input id = "loop_" style ="width:2.5%" type = "text" onchange = "Set_()" value="'+loop_num+'"></input></td></tr>';
			tbody += '<tr><td>每个回路的输出位数量:</td>';
			tbody += '<td><input id = "out_num1" style ="width:2.5%" type = "text" onchange = "Set_()" value="'+loop_out[0]+'"></input>';
			tbody += '&nbsp&nbsp<input id = "out_num2" style ="width:2.5%;" type = "text" onchange = "Set_()" value="'+loop_out[1]+'"></input>';
			tbody += '&nbsp&nbsp<input id = "out_num3" style ="width:2.5%;" type = "text" onchange = "Set_()" value="'+loop_out[2]+'"></input>';
			tbody += '&nbsp&nbsp<input id = "out_num4" style ="width:2.5%;" type = "text" onchange = "Set_()" value="'+loop_out[3]+'"></input>';
			tbody += '&nbsp&nbsp<input id = "out_num5" style ="width:2.5%;" type = "text" onchange = "Set_()" value="'+loop_out[4]+'"></input>';
			tbody += '&nbsp&nbsp<input id = "out_num6" style ="width:2.5%;" type = "text" onchange = "Set_()" value="'+loop_out[5]+'"></input></td></tr>';
			tbody += '<tr><td>带不带断路器:</td>';
			tbody += '<td><input id = "break_" style ="width:2.5%" type = "text" onchange = "Set_()" value="' + break_en + '"></input>(0-不带断路器,1-带断路器)</td></tr>';
			tbody += '<tr><td></td><td></td></tr>';


			tbody += '<tr><td>屏幕方向角:</td>';
			tbody += '<td><input id = "angle_" style ="width:2.5%" type = "text" onchange = "Set_()"  value="'+cfg_data[0]+'">(0-0°垂直,1-90°水平,2-180°垂直(翻转),3-270°水平(翻转))</input></td></tr>';
			tbody += '<tr><td>版本类型:</td>';
			tbody += '<td><input id = "ver_mode_" style ="width:2.5%" type = "text" onchange = "Set_()"value="'+cfg_data[1]+'">(0-标准,1-中性)</input></td></tr>';
			tbody += '<tr><td>设备类型:</td>';
			tbody += '<td><input id = "dev_type_" style ="width:8%" type = "text" onchange = "Set_()" value="'+cfg_data[2]+'"></input></td></tr>';
			tbody += '<tr><td>带不带传感器盒子:</td>';
			tbody += '<td><input id = "serson_box_" style ="width:2.5%" type = "text" onchange = "Set_()" value="'+cfg_data[3]+'">(0-不带,1-带)</input></td></tr>';
			tbody += '<tr><td>设备系列选择:</td>';
			tbody += '<td><input id = "ser_sel_" style ="width:2.5%" type = "text" onchange = "Set_()" value="'+cfg_data[4]+'">(1-A系列,2-B系列,3-C系列,4-D系列)</input></td></tr>';
			tbody += '<tr><td></td><td></td></tr>';

			tbody += '<tr><td>语言选择:</td>';
			tbody += '<td><input id = "language_" style ="width:2.5%" type = "text" onchange = "Set_()" value="'+cfg_data[5]+'"></input>(0-中文,1-英文)</td></tr>';
			tbody += '<tr><td>MAC地址:</td>';
			tbody += '<td><input id = "mac_" style ="width:24.5%" type = "text" onchange = "Set_()" value="'+cfg_data[6]+'"></input></td></tr>';
			tbody += '<tr><td><input style ="width:100px" type = "button" onclick = "Set_()" value="保存"></input></td><td></td></tr>';
			tbody += '<tr><td></td><td></td></tr>';
			return '<thead>' + thead + '</thead>'
				 + '<tbody>' + tbody + '</tbody>';
		}
		function buildTableThreshold() {
			var thead = '',tbody = '';
			thead = '<tr><td style="font-size:20px;" colspan = "3">阈值统一设置</td>\
			<td width ="8%"></td>\
			<td width ="8%"></td>\
			<td width ="8%"></td>\
			<td width ="8%"></td><td width ="47%"></td></tr>';
			tbody += '<tr><td width ="5%">序号</td><td width ="8%">数据类型</td><td width ="8%" >额定值</td><td width ="8%" >最小值</td><td>下临界值</td><td>上临界值</td><td>最大值</td><td></td></tr>';
			tbody += '<tr><td>1</td><td>相电压(V)</td><td><input id = "'+unite_id[0]+0+'" style ="width:60.5%" type = "text" onchange ="power_calculation()" value ="220"></input></td>\
				<td><input id = "'+unite_id[0]+1+'" style ="width:60.5%" type = "text" value ="80"></input></td>\
				<td><input id = "'+unite_id[0]+2+'" style ="width:60.5%" type = "text" value ="80"></input></td>\
				<td><input id = "'+unite_id[0]+3+'" style ="width:60.5%" type = "text" value ="240"></input></td>\
				<td><input id = "'+unite_id[0]+4+'" style ="width:60.5%" type = "text" value ="240"></input></td><td></td></tr>';
			tbody += '<tr><td>2</td><td>相电流(A)</td><td><input id = "'+unite_id[1]+0+'" style ="width:60.5%" type = "text" onchange ="power_calculation()" value ="63"></input></td>\
				<td><input id = "'+unite_id[1]+1+'" style ="width:60.5%" type = "text" value ="0"></input></td>\
				<td><input id = "'+unite_id[1]+2+'" style ="width:60.5%" type = "text" value ="0"></input></td>\
				<td><input id = "'+unite_id[1]+3+'" style ="width:60.5%" type = "text" value ="63"></input></td>\
				<td><input id = "'+unite_id[1]+4+'" style ="width:60.5%" type = "text" value ="63"></input></td><td></td></tr>';
			tbody += '<tr><td>3</td><td>相功率(kW)</td><td><input id = "'+unite_id[2]+0+'" style ="width:60.5%" type = "text" value ="14.080"></input></td>\
				<td><input id = "'+unite_id[2]+1+'" style ="width:60.5%" type = "text" value ="0"></input></td>\
				<td><input id = "'+unite_id[2]+2+'" style ="width:60.5%" type = "text" value ="0"></input></td>\
				<td><input id = "'+unite_id[2]+3+'" style ="width:60.5%" type = "text" value ="14.080"></input></td>\
				<td><input id = "'+unite_id[2]+4+'" style ="width:60.5%" type = "text" value ="14.080"></input></td><td></td></tr>';
			tbody += '<tr><td>4</td><td>回路电压(V)</td><td><input id = "'+unite_id[3]+0+'" style ="width:60.5%" type = "text" onchange ="power_calculation()" value ="220"></input></td>\
				<td><input id = "'+unite_id[3]+1+'" style ="width:60.5%" type = "text" value ="80"></input></td>\
				<td><input id = "'+unite_id[3]+2+'" style ="width:60.5%" type = "text" value ="80"></input></td>\
				<td><input id = "'+unite_id[3]+3+'" style ="width:60.5%" type = "text" value ="240"></input></td>\
				<td><input id = "'+unite_id[3]+4+'" style ="width:60.5%" type = "text" value ="240"></input></td><td></td></tr>';
			tbody += '<tr><td>5</td><td>回路电流(A)</td><td><input id = "'+unite_id[4]+0+'" style ="width:60.5%" type = "text" onchange ="power_calculation()" value ="32"></input></td>\
				<td><input id = "'+unite_id[4]+1+'" style ="width:60.5%" type = "text" value ="0"></input></td>\
				<td><input id = "'+unite_id[4]+2+'" style ="width:60.5%" type = "text" value ="0"></input></td>\
				<td><input id = "'+unite_id[4]+3+'" style ="width:60.5%" type = "text" value ="32"></input></td>\
				<td><input id = "'+unite_id[4]+4+'" style ="width:60.5%" type = "text" value ="32"></input></td><td></td></tr>';
			tbody += '<tr><td>6</td><td>回路功率(kW)</td><td><input id = "'+unite_id[5]+0+'" style ="width:60.5%" type = "text" value ="7.040"></input></td>\
				<td><input id = "'+unite_id[5]+1+'" style ="width:60.5%" type = "text" value ="0"></input></td>\
				<td><input id = "'+unite_id[5]+2+'" style ="width:60.5%" type = "text" value ="0"></input></td>\
				<td><input id = "'+unite_id[5]+3+'" style ="width:60.5%" type = "text" value ="7.040"></input></td>\
				<td><input id = "'+unite_id[5]+4+'" style ="width:60.5%" type = "text" value ="7.040"></input></td><td></td></tr>';
			tbody += '<tr><td>7</td><td>输出位电流(A)</td><td><input id = "'+unite_id[6]+0+'" style ="width:60.5%" type = "text" onchange ="power_calculation()" value ="16"></input></td>\
				<td><input id = "'+unite_id[6]+1+'" style ="width:60.5%" type = "text" value ="0"></input></td>\
				<td><input id = "'+unite_id[6]+2+'" style ="width:60.5%" type = "text"  value ="0"></input></td>\
				<td><input id = "'+unite_id[6]+3+'" style ="width:60.5%" type = "text"  value ="16"></input></td>\
				<td><input id = "'+unite_id[6]+4+'" style ="width:60.5%" type = "text"  value ="16"></input></td><td></td></tr>';
			tbody += '<tr><td>8</td><td>输出位功率(kW)</td><td><input id = "'+unite_id[9]+0+'" style ="width:60.5%" type = "text" value ="2.20"></input></td>\
				<td><input id = "'+unite_id[9]+1+'" style ="width:60.5%" type = "text" value ="0"></input></td>\
				<td><input id = "'+unite_id[9]+2+'" style ="width:60.5%" type = "text"  value ="0"></input></td>\
				<td><input id = "'+unite_id[9]+3+'" style ="width:60.5%" type = "text"  value ="1.76"></input></td>\
				<td><input id = "'+unite_id[9]+4+'" style ="width:60.5%" type = "text"  value ="2.20"></input></td><td></td></tr>';
			tbody += '<tr><td>9</td><td>温度(℃)</td><td><input id = "'+unite_id[7]+0+'" style ="width:60.5%" type = "text" onchange ="power_calculation()" readonly ="true" value ="40"></input></td>\
				<td><input id = "'+unite_id[7]+1+'" style ="width:60.5%" type ="text" value ="0"></input></td>\
				<td><input id = "'+unite_id[7]+2+'" style ="width:60.5%" type = "text" value ="0"></input></td>\
				<td><input id = "'+unite_id[7]+3+'" style ="width:60.5%" type = "text" value ="40"></input"></td>\
				<td><input id = "'+unite_id[7]+4+'" style ="width:60.5%" type = "text" value ="40"></input></td><td></td></tr>';
			tbody += '<tr><td>10</td><td>湿度(%)</td><td><input id = "'+unite_id[8]+0+'" style ="width:60.5%" type = "text" onchange ="power_calculation()" readonly ="true" value ="90"></input></td>\
				<td><input id = "'+unite_id[8]+1+'" style ="width:60.5%" type = "text" value ="0"></input></td>\
				<td><input id = "'+unite_id[8]+2+'" style ="width:60.5%" type = "text"  value ="0"></input></td>\
				<td><input id = "'+unite_id[8]+3+'" style ="width:60.5%" type = "text"  value ="90"></input></td>\
				<td><input id = "'+unite_id[8]+4+'" style ="width:60.5%" type = "text"  value ="90"></input></td><td></td></tr>';
			tbody += '<tr><td colspan = "3" ><input style ="width:100px" type = "button" onclick = "AllSet()" value="统一设置"></input></td><td></td><td></td><td></td><td></td><td></td></tr>';
			tbody += '<tr><td></td><td></td></tr>';
			return '<thead>' + thead + '</thead>'
				 + '<tbody>' + tbody + '</tbody>';
		}
		function buildTableOutput() {
			var thead = '',tbody = '';
			thead = '<tr><td style="font-size:20px;" colspan = "61">输出位额定电流值设置</td></tr>';
			tbody +='<tr><td width = "5%" style ="text-align:center">输出位</td>';
				for(let i = 0;i<12;i++){
				tbody +='<td width = "1.5%" style ="text-align:center">'+ ((i * 4)+1) + '</td>';
				tbody +='<td width = "1.5%" style ="text-align:center">'+ ((i * 4)+2) + '</td>';
				tbody +='<td width = "1.5%" style ="text-align:center">'+ ((i * 4)+3) + '</td>';
				tbody +='<td width = "1.5%" style ="text-align:center">'+ ((i * 4)+4) + '</td>';
				tbody +='<td width = "1.5%"></td>';
			}
			tbody +='</tr>';
			tbody +='<tr><td width = "5%" style ="text-align:center">16A</td>';
			for(let i = 0;i<12;i++){
				tbody +='<td width = "1.5%"><input type = "checkbox" class = "input" onchange ="cked(this)" id = "a'+ ((i * 4)+1) + '"></input></td>';
				tbody +='<td width = "1.5%"><input type = "checkbox" class = "input" onchange ="cked(this)" id = "a'+ ((i * 4)+2) + '"></input></td>';
				tbody +='<td width = "1.5%"><input type = "checkbox" class = "input" onchange ="cked(this)" id = "a'+ ((i * 4)+3) + '"></input></td>';
				tbody +='<td width = "1.5%"><input type = "checkbox" class = "input" onchange ="cked(this)" id = "a'+ ((i * 4)+4) + '"></input></td>';
				tbody +='<td width = "1.5%"></td>';
			}
			tbody +='</tr>';
			tbody +='<tr><td width = "5%" style ="text-align:center">10A</td>';
			for(let i = 0;i<12;i++){
				tbody +='<td width = "1.5%"><input type = "checkbox" class = "input" onchange ="cked(this)" id = "b'+ ((i * 4)+1) + '"></input></td>';
				tbody +='<td width = "1.5%"><input type = "checkbox" class = "input" onchange ="cked(this)" id = "b'+ ((i * 4)+2) + '"></input></td>';
				tbody +='<td width = "1.5%"><input type = "checkbox" class = "input" onchange ="cked(this)" id = "b'+ ((i * 4)+3) + '"></input></td>';
				tbody +='<td width = "1.5%"><input type = "checkbox" class = "input" onchange ="cked(this)" id = "b'+ ((i * 4)+4) + '"></input></td>';
				tbody +='<td width = "1.5%"></td>';
			}
			tbody +='</tr>';
			tbody +='<tr><td width = "5%" style ="text-align:center"><input id = "cur_val" style ="width:35%;text-align:center" type = "text"  value ="0">A</input></td>';
			for(let i = 0;i<12;i++){
				tbody +='<td width = "1.5%"><input type = "checkbox" class = "input" onchange ="cked(this)" id = "c'+ ((i * 4)+1) + '"></input></td>';
				tbody +='<td width = "1.5%"><input type = "checkbox" class = "input" onchange ="cked(this)" id = "c'+ ((i * 4)+2) + '"></input></td>';
				tbody +='<td width = "1.5%"><input type = "checkbox" class = "input" onchange ="cked(this)" id = "c'+ ((i * 4)+3) + '"></input></td>';
				tbody +='<td width = "1.5%"><input type = "checkbox" class = "input" onchange ="cked(this)" id = "c'+ ((i * 4)+4) + '"></input></td>';
				tbody +='<td width = "1.5%"></td>';
			}
			tbody +='</tr>';
			tbody += '<tr><td colspan = "61"><input style ="width:100px" type = "button" onclick = "Set()" value="保存"></input></td></tr>';
			tbody += '<tr><td></td><td></td></tr>';
			return '<thead>' + thead + '</thead>'
				 + '<tbody>' + tbody + '</tbody>';
		}
		function buildTableVol() {
			var thead = '',tbody = '';
			thead = '<tr><td style="font-size:20px;text-align:left" colspan = "31">输出位电压值</td></tr>';
			tbody +='<tr><td width = "5%" style ="text-align:center">输出位</td>';
				for(let i = 0;i<6;i++){
				tbody +='<td width = "3%" style ="text-align:center">'+ ((i * 4)+1) + '</td>';
				tbody +='<td width = "3%" style ="text-align:center">'+ ((i * 4)+2) + '</td>';
				tbody +='<td width = "3%" style ="text-align:center">'+ ((i * 4)+3) + '</td>';
				tbody +='<td width = "3%" style ="text-align:center">'+ ((i * 4)+4) + '</td>';
				tbody +='<td width = "3%"></td>';
			}
			tbody +='</tr>';
			tbody +='<tr><td width = "5%" style ="text-align:center">电压(V)</td>';
			for(let i = 0;i<6;i++){
				tbody +='<td width = "3%" id = "vol'+ ((i * 4)+1) + '">'+out_vol[(i * 4)+1]+'</td>';
				tbody +='<td width = "3%" id = "vol'+ ((i * 4)+2) + '">'+out_vol[(i * 4)+2]+'</td>';
				tbody +='<td width = "3%" id = "vol'+ ((i * 4)+3) + '">'+out_vol[(i * 4)+3]+'</td>';
				tbody +='<td width = "3%" id = "vol'+ ((i * 4)+4) + '">'+out_vol[(i * 4)+4]+'</td>';
				tbody +='<td width = "3%"></td>';
			}
			tbody +='<tr><td width = "5%" style ="text-align:center">输出位</td>';
				for(let i = 6;i<12;i++){
				tbody +='<td width = "3%" style ="text-align:center">'+ ((i * 4)+1) + '</td>';
				tbody +='<td width = "3%" style ="text-align:center">'+ ((i * 4)+2) + '</td>';
				tbody +='<td width = "3%" style ="text-align:center">'+ ((i * 4)+3) + '</td>';
				tbody +='<td width = "3%" style ="text-align:center">'+ ((i * 4)+4) + '</td>';
				tbody +='<td width = "3%"></td>';
			}
			tbody +='</tr>';
			tbody +='<tr><td width = "5%" style ="text-align:center">电压(V)</td>';
			for(let i = 6;i<12;i++){
				tbody +='<td width = "3%" id = "vol'+ ((i * 4)+1) + '">'+out_vol[(i * 4)+1]+'</td>';
				tbody +='<td width = "3%" id = "vol'+ ((i * 4)+2) + '">'+out_vol[(i * 4)+2]+'</td>';
				tbody +='<td width = "3%" id = "vol'+ ((i * 4)+3) + '">'+out_vol[(i * 4)+3]+'</td>';
				tbody +='<td width = "3%" id = "vol'+ ((i * 4)+4) + '">'+out_vol[(i * 4)+4]+'</td>';
				tbody +='<td width = "3%"></td>';
			}
			tbody +='</tr>';
			return '<thead>' + thead + '</thead>'
				 + '<tbody>' + tbody + '</tbody>';
		}
    </script>
</body>
</html>
