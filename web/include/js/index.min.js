function buildNav(navArr) {
    for (var html = "", i = 0; i < navArr.length; i++) {
        html += '<li class="nav-item' + (0 === i ? " is-active" : "") + " " + (navArr[i].subNav && navArr[i].subNav.length ? "has-subnav" : "") + '"><a class="nav-item-link" href="' + (navArr[i].url || "javascript:;") + '" target="mainCont">', navArr[i].icon && (html += '<i class="iconfont ' + navArr[i].icon + '"></i>'), html += navArr[i].name + "</a>";
        var subNav = navArr[i].subNav;
        if (subNav && subNav.length) {
            html += '<ul class="subnav">';
            for (var j = 0; j < subNav.length; j++) html += '<li><a href="' + navArr[i].base + subNav[j].url + '" target="mainCont">' + subNav[j].name + "</a></li>";
            html += "</ul>"
        }
        subNav = null, html += "</li>"
    }
    $("#nav").html(html), html = null, $(".sys-title").click(function() {
        $(this).parent().toggleClass("is-fold")
    }), bindNavEvt($("#nav"))
}

function bindNavEvt(nav) {
    var lastSubNav = null;
    nav.on("click", "a", function(e) {
        var self = $(this),
            subNav = self.parents(".nav-item").children("ul");
        self.parent().is(".nav-item") ? (lastSubNav && lastSubNav.hide(240), subNav.length && (subNav.is(":animated") || (subNav.slideToggle(240), lastSubNav = subNav))) : nav.parent().hasClass("is-fold") && subNav.hide(), e.stopPropagation()
    })
}
var fname = "nav";
if(1){
    fname = "bak";
}
$(window).on("load resize", function() {
    var titleHt = $(".sys-title:eq(0)").outerHeight(),
        ht = $(window).height() - titleHt - 10;
    $("#nav").height(ht)
}), $.getJSON("include/js/"+ fname +".json?" + +new Date, function(navArr) {
    buildNav(navArr);
    var pageURL = navArr[0].url || navArr[0].subNav[0].url;
    $("#mainCont").attr("src", pageURL)
});