<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="ie=edge,chrome=1">
	<meta name="renderer" content="webkit">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>home</title>
	<link rel="stylesheet" href="include/css/public.min.css">
	<link rel="stylesheet" href="include/css/iconfont.min.css">
	<link rel="stylesheet" href="include/css/font-awesome.min.css">
	<link rel="stylesheet" href="include/css/index.min.css">

	<script src="include/js/jquery-1.11.3.min.js"></script>
	<script src="include/js/chart.min.js"></script>
	<script src="include/js/public.min.js"></script>
	<script src="include/js/pdu_rpc.js"></script>
	<style>
		.box {
			border: 1px solid #C4C2C3;
			background-color: #fff;
		}

		tr {
			height: 30px;
		}
	</style>
</head>

<body>
	<div style="padding: 0px; margin-bottom: 0.8%; overflow: hidden; ">
		<div class="box" style="width: 100%; margin-bottom: 0.8%;  background:#e7e7e7;">
			<div class="panel panel-default">
				<div class="panel-heading"><i class="fa fa-sitemap fa-lg" style="padding-right: 5px;"></i><span
						id="lang_1"></span>
					<ul id="dev_sel" style="float:right; padding-right:5%;font-family:courier;display: none;"><span
							id="lang_2"></span><select class="devname" id="ms" style="width:100px;"
							onChange="Change(this);"></select></ul>
				</div>
			</div>
			<div class="phase_div1">
				<div class="phase_div2" id="lang_3"></div>
				<div class="phase_div">
					<table class="phase_table total"></table>
				</div>
				<div class="phase" id="L1" style="display: none;">
					<table class="phase_table p1"></table>
				</div>
				<div class="phase " id="L2" style="display: none;">
					<table class="phase_table p2"></table>
					</table>
				</div>
				<div class="phase" id="L3" style="display: none;">
					<table class="phase_table p3"></table>
				</div>
			</div>
			<div id="ht" class="loop_div">
				<table class="loop_table "></table>
			</div>
			<table style="width:100%;height:203px; ">
				<tr>
					<td style=" width: 99%;">
						<div
							style=" width: 99%; margin-bottom: 0.8%; border:1px solid;border-color: #ffffff; margin-left:10px; height:203px; background:#ffffff; text-align:center;">
							<div style="text-align:left; padding-left:20px; padding-top:8px; height:40px; border-bottom:#e1dfdf 2px solid; font-size:12px;"
								id="lang_16"></div>
							<table class="sensor_tab"
								style="height:32px;width:100%; font-size:12px;border:1px solid;border-color: #ffffff;">
							</table>
						</div>
					</td>
				</tr>
			</table>
			<div align="center"
				style="border:0px solid;border-color: #aaaaff; margin:0px 10px 10px 10px; height:550px; background:#ffffff;">
				<div style="text-align:left; padding-left:20px; padding-top:8px; height:40px; border-bottom:#e1dfdf 2px solid;"
					id="lang_35"></div>

				<br>
				<ul style="padding-right:70%; font-family:courier;"><span id=""></span><select id="sel1"
						style="width:100px;" onChange="ChangeMode(this);"></select></ul>
				<div id="container" style="width:90%; height:500px;">
					<canvas id="chart" style="display: block; width: 90%; height: 410px;"></canvas>
				</div>
				<script type="text/javascript">
					let pdu_cfg = top.pdu_cfg_;
					let language;
					let Tm1 = 350;//950;
					let Tm2 = 200;//900;
					if(top.first_time == 1){
						Tm1 = 15;
						Tm2 = 10;
					}
					let chart_lang = new Array();
					let sel_name = new Array(3);
					let sample_num = 50;
					let data_total = new Array(50);
					let data_inlet1 = new Array(50);
					let data_inlet2 = new Array(50);
					let data_inlet3 = new Array(50);
					let data_view = new Array(50);
					let date = new Date();
					let time1 = 0;
					let chart = 0;
					let ctx = 0;
					let uint_arr = new Array("kW", "A", "V");
					let uint_arr_ = uint_arr[0];
					let chart_type = 0;
					let title_text = "";
					let mark_num = new Array(0, 0);
					let Hou = 0, Minu = 0, Seco = 0;
					let total_mark = 0;
					Seco = date.getSeconds();
					Minu = date.getMinutes();
					Hou = date.getHours();
					let dataLabels = new Array();
					if(top.login_permit_ == 1){
						$("input").attr("disabled","disabled");
						$("select").attr("disabled","disabled");
					}else{
					}
					function SetDataShow(num) {
						for (let j = 0; j < sample_num; j++) {
							data_total[j] = top.total_data[num][j];
							data_inlet1[j] = top.inletA_data[num][j];
							data_inlet2[j] = top.inletB_data[num][j];
							data_inlet3[j] = top.inletC_data[num][j];
						}
					}
					setTimeout(function(){
						top.first_time = 1;
						ChartLangInit();
						SetDataShow(0);
						ctx = document.getElementById('chart').getContext('2d');
						chart = new Chart(ctx, config);
					}, Tm1);
					function ChartLangInit() {
						for (let i = 0; i < 16; i++) {
							chart_lang[i] = new Array();
						}
						chart_lang[1] = ["功率", "", "", "", ""];
						chart_lang[2] = ["电流", "", "", "", ""];
						chart_lang[3] = ["电压", "", "", "", ""];
						chart_lang[4] = ["相信息实时统计图表显示", "", "", "", ""];
						sel_name[0] = chart_lang[1][language];
						sel_name[1] = chart_lang[2][language];
						sel_name[2] = chart_lang[3][language];
						title_text = chart_lang[4][language];
						for (let k = sample_num; k > 0; k--) {

							data_view[k] = 0;
							Seco -= 3;
							if (Seco < 0) {
								Seco = 60 + Seco - 3;
								Minu -= 1;
								if (Minu < 0) {
									Minu = 59;
									Hou -= 1;
								}
								if (Hou < 0) {
									Hou = 23;
								}
							}
							dataLabels[k - 1] = (Hou < 10 ? '0' + Hou : Hou) + ':' + (Minu < 10 ? '0' + Minu : Minu) + ':' + (Seco < 10 ? '0' + Seco : Seco);
						}
						for (let i = 0; i < 3; i++) {
							document.getElementById("sel1").options.add(new Option(sel_name[i], i));
						}
					}

					let config = {
						type: 'line',
						data: {
							labels: dataLabels,
							datasets: [
								{
									label: 'L1',
									data: data_inlet1,
									backgroundColor: 'rgb(75, 192, 192)',
									borderColor: 'rgb(75, 192, 192)',
									fill: false,
									borderWidth: 1.5,
									pointRadius: 2,
								},
								{
									label: 'L2',
									data: data_inlet2,
									backgroundColor: 'rgb(128, 128, 128)',
									borderColor: 'rgb(128, 128, 128)',
									fill: false,
									borderWidth: 1.5,
									pointRadius: 2,
								},
								{
									label: 'L3',
									data: data_inlet3,
									backgroundColor: 'rgb(70, 130, 180)',
									borderColor: 'rgb(70, 130, 180)',
									fill: false,
									borderWidth: 1.5,
									pointRadius: 2,
								},
								{
									label: 'Total',
									data: data_total,
									backgroundColor: 'rgb(255, 99, 132)',
									borderColor: 'rgb(255, 99, 132)',
									fill: false,
									borderWidth: 1.5,
									pointRadius: 2,
								}
							]
						},
						options: {
							responsive: true,
							plugins: {
								title: {
									display: true,
									text: title_text
								},
							},
							interaction: {
								mode: 'index',
								intersect: false
							},
							scales: {
								x: {
									display: true,
									title: {
										display: true,
									},
									grid:{
										display:false,
									}
								},
								y: {
									display: true,
									title: {
										display: true,
										text: uint_arr_
									},
									min : 0
								}
							}
						}
					};
					function CreateNewChart() {
						if (mark_num[1] == 1) {
							chart.data.datasets.pop();
							chart.update();
						}
						if (mark_num[0] == 1) {
							let newDateset = { label: "Total", data: data_total, backgroundColor: 'rgb(255, 99, 132)', borderColor: 'rgb(255, 99, 132)', fill: false, borderWidth: 1.5, pointRadius: 2, };
							chart.data.datasets.push(newDateset);
							chart.update();
						}
						document.getElementById('chart').remove();
						//document.getElementsByClassName('chartjs-size-monitor')[0].remove();
						let e = document.createElement("canvas");
						e.id = "chart";
						e.style.display = "block";
						e.style.width = "90%";
						e.style.height = "410px";
						document.getElementById('container').appendChild(e);

						ctx = document.getElementById('chart').getContext('2d');
						chart = new Chart(ctx, config);
						time1 = setInterval(FlashChart, 3000);
					}
					function ChangeMode(obj) {
						chart_type = parseInt(obj.value);
						clearInterval(time1);
						uint_arr_ = uint_arr[chart_type];
						if (chart_type == 0) {
							mark_num[0]++;
							mark_num[1] = 0;
						} else {
							mark_num[0] = 0;
							mark_num[1]++;
						}
						CreateNewChart();
						SetDataShow(chart_type);
						if (chart_type == 0) {
							config.data.datasets[0].data = data_inlet1;
							config.data.datasets[1].data = data_inlet2;
							config.data.datasets[2].data = data_inlet3;
							config.data.datasets[3].data = data_total;
						} else {
							config.data.datasets[0].data = data_inlet1;
							config.data.datasets[1].data = data_inlet2;
							config.data.datasets[2].data = data_inlet3;
						}
						config.options.scales.y.title.text = uint_arr_;
						chart.update();
					}
					function FlashChart() {
						if (config.data.datasets.length > 0) {
							date = new Date();
							Seco = date.getSeconds();
							Minu = date.getMinutes();
							Hou = date.getHours();
							label_ = (Hou < 10 ? '0' + Hou : Hou) + ':' + (Minu < 10 ? '0' + Minu : Minu) + ':' + (Seco < 10 ? '0' + Seco : Seco);

							dataLabels.push(label_);
							if (chart_type == 0) {
								data_total.push(top.total_data[chart_type][49]);
							}
							data_inlet1.push(top.inletA_data[chart_type][49]);
							data_inlet2.push(top.inletB_data[chart_type][49]);
							data_inlet3.push(top.inletC_data[chart_type][49]);
							if (chart_type == 1) {
								data_total.shift();
							}
							dataLabels.shift();
							data_inlet1.shift();
							data_inlet2.shift();
							data_inlet3.shift();

							chart.update();
						}
					}
					
					time1 = setInterval(FlashChart, 3000);
					function getRandomNum(min, max) {
						var range = max - min;
						var rand = Math.random();
						return (min + Math.round(rand * range));
					}
				</script>
			</div>
			<div style="height: 100px;background-color: #e7e7e7;">
			</div>
		</div>
	</div>
	</div>
	<script>
		var default_addr = 0;
		let phase_num;
		let loop_num;
		let slave_num;
		let loop_info_ = new Array();
		let phase_info = new Array();
		let loop_info = new Array();
		let sensor_info = new Array();
		let freq_;
		let loop_se = new Array();
		let total_info = new Array();
		let system_info = new Array();
		let total_title = new Array("kW", "kVA", "kWh", "Hz", "mA");
		let lang = new Array(36);
		let dev_name = new Array();
		let head = new Array("Tmp", "Tmp", "Hum", "Hum", "Door1", "Door2", "Water", "Smoke");
		let stat_ = new Array("", "", "");
		let serial_ = new Array("D", "A", "B", "C", "D");
		let Sensor_state = new Array("NA", "", "");
		let Sensor_state_ = new Array("NA", "", "");
		let Sys_state = new Array("正常", "告警", "故障");
		let loop_unit = new Array("", "", "", "A", "A", "V", "kW", "kWh");
		let sample_ = new Array(5, 0, 1);
		let pdu_data;
		let phase_arr = ["cur_value","vol_value","pf","cur_alarm_status","cur_alarm_max","pow_value"];
		let loop_arr = ["breaker","apparent_pow","cur_value","cur_alarm_max","vol_value","pow_value","ele"];
		let loop_arr1 = ["apparent_pow","cur_value","cur_alarm_max","vol_value","pow_value","ele"];
		let total_arr = ["pow","apparent_pow","ele"];
		let sensor_arr = ["tem_value","hum_value","tem_value","hum_value","door","door","water","smoke"];
		let sensor_id = [0,0,1,1,0,1,0,0];
		function ParseData(){
			let DataString = pdu_cfg.meta_value();
			if(DataString == null){
				setTimeout(function(){ParseData()}, pdu_cfg.getTimeOut());
				return ;
			}

			pdu_data = JSON.parse(DataString);
			phase_num = pdu_data.pdu_info.line_num;
			loop_num = pdu_data.pdu_info.loop_num;
			slave_num = pdu_data.pdu_info.slave_num;
			language = pdu_data.pdu_info.language;
			top.language_ = language;
			freq_ = pdu_data.pdu_info.pdu_hz;
			let k = 0;
			for(let i = 0;i<phase_num;i++){
				phase_info[i] = new Array();
				let j = 0;
				for(let key of phase_arr){
					phase_info[i][j] = pdu_data.pdu_data.line_item_list[key][i];
					j ++;
				//if(j > 5){
				//	break;
				//}
				}
			}
			for(let i = 0;i<loop_num;i++){
				if(pdu_data.pdu_info.pdu_spec == 1){
					loop_se[i] = "-" + "-" + "-";	
				}else{
					loop_se[i] = pdu_data.pdu_info.loop_start[i] + "-" + pdu_data.pdu_info.loop_ends[i];
				}
			}
			for(let i = 0;i<loop_num;i++){
				loop_info[i] = new Array();
				loop_info[i][0] = "C" + (i + 1);
				let j = 1;
				if(pdu_data.pdu_data.loop_item_list.breaker != undefined){
					for(let key of loop_arr){
						if(j == 2){
							loop_info[i][j] = loop_se[i];
						}else{
							loop_info[i][j] = pdu_data.pdu_data.loop_item_list[key][i];
						}
						j ++;
					}
				}else{
					for(let key of loop_arr1){
						if(j == 1){
							loop_info[i][j] = loop_se[i];
						}else{
							loop_info[i][j] = pdu_data.pdu_data.loop_item_list[key][i];
						}
						j ++;
					}
				}
			}
			k = 0;
			for(let key of sensor_arr){
				sensor_info[k] = pdu_data.pdu_data.env_item_list[key][sensor_id[k]];
				k ++;
			}
			k = 0;
			for(let key of total_arr){
				total_info[k] = pdu_data.pdu_data.pdu_tg_data[key];
				k++;
			}
			total_info[3] = freq_;
		}
		setTimeout(function(){
			ParseData();
			LangInit();
		},Tm2);
		setTimeout(function(){
			$('.total').html(BuildTablePhase(0));
			$('.p1').html(BuildTablePhase(1));
			$('.p2').html(BuildTablePhase(2));
			$('.p3').html(BuildTablePhase(3));
			$('.loop_table').html(BuildTableLoop(loop_num));
			$('.sensor_tab').html(BuildTableSensor());
			// $('.sys_table').html(BuildTableSystem());
			$('.devname').html(BuildSel((slave_num + 1)));
			ReadData();
			LangFun();
		},Tm1);
		function Change(sel){
			top.addr_ = parseInt(sel.value);
			pdu_cfg.addr = parseInt(sel.value);
			pdu_cfg.setAddr(pdu_cfg.addr);
			setTimeout(function(){
				PduMetaData.meta_workDown(top.addr_);
			},100);
			setTimeout(function(){
				ParseData();
				ShowData();
				LangFun();
			},500);
		}
		function delay() {
			for (let i = 0; i < 50; i++) { }
		}
		function LangInit() {
			for (let i = 0; i < lang.length; i++) {
				lang[i] = new Array();
			}
			lang[1] = ["首页", "Dashboard", "Tableau", "Первая страница", "Página", "منزل"];
			lang[2] = ["设备选择:", "PDU Selection: ", "Dispositif Choix:", "Выбор устройства:", "Selección del dispositivo:", "اختيار المعدات:"];
			lang[3] = ["总数据", "Input ", "Input", "вход", "Entrada", "دخول"];
			lang[4] = ["电能消耗:", "Electric energy: ", "Énergie électrique: ", "расход электроэнергии: ", "Consumo de energía eléctrica: ", "استهلاك الطاقة"];
			lang[5] = ["频率:", "Frequency:", "Fréquence:", "частота:", "Frecuencia:", "تردد:"];
			lang[6] = ["漏电电流:", "Leakage current:", "Courant de fuite:", , "ток утечки:", "corriente de fuga:", "التسرب الحالي:"];
			lang[7] = ["回路数据", "Output", "Output", "выход", "Salida", "تصدير"];
			lang[8] = ["回路", "Circuit", "Circuit", "цепь", "Vuelta", "فرع الطريق"];
			lang[9] = ["状态", "Status", "état", "состояние", "Estado", "دولة"];
			lang[10] = ["输出位", "Outlet", "Output bit", "выходной бит", "Salida de salida", "الانتاج قليلا"];
			lang[11] = ["当前电流", "Load current", "Courant", "текущий ток", "Corriente actual", "التيار الحالي"];
			lang[12] = ["过载电流", "Overload current", "Surcharge Courant", "максимальный ток", "Corriente de sobrecarga", "الزائد الحالي"];
			lang[13] = ["当前电压", "Input voltage", "Tension", "текущее напряжение", "Tensión actual", "الجهد"];
			lang[14] = ["有功功率", "Apparent power", "Puissance optique", "кажущаяся мощность", "Potencia visual", "القوة الظاهرة"];
			lang[15] = ["电能消耗", "Energy consumption", "Énergie électrique", "расход электроэнергии", "Consumo de energía eléctrica", "استهلاك الطاقة"];
			lang[16] = ["传感器", "Sensor", "Capteur", "датчик", "Sensor", "الاستشعار"];
			lang[17] = ["传感器名称", "Sensor name", "Capteur Nom", "наименование датчика", "Nombre del sensor", "اسم المستشعر"];
			lang[18] = ["传感器状态", "Sensor status", "Capteur état", "состояние датчика", "Estado del sensor", "حالة الاستشعار"];
			lang[19] = ["传感器名称", "Sensor name", "Capteur Nom", "наименование датчика", "Nombre del sensor", "اسم المستشعر"];
			lang[20] = ["传感器状态", "Sensor status", "Capteur état", "состояние датчика", "Estado del sensor", "حالة الاستشعار"];
			lang[21] = ["温度1", "Temperature 1", "Temperature 1", "температура1", "Temperatura 1", "درجة الحرارة 1"];
			lang[22] = ["湿度1", "Humidity 1", "Humidité 1", "влажность1", "Temperatura 1", "الرطوبة 1"];
			lang[23] = ["温度2", "Temperature 2", "Temperature 2", "температура2", "Temperatura 2", "درجة الحرارة 2"];
			lang[24] = ["湿度2", "Humidity 2", "Humidité 2", "влажность2", "Temperatura 2", "الرطوبة 2"];
			lang[25] = ["门禁1", "Doohttps://192.168.10.96/index.htmlr1", "Door1", "вход1", "Puerta 1", "التحكم في الوصول 1"];
			lang[26] = ["门禁2", "Door2", "Door2", "вход2", "Puertas 2", "التحكم في الوصول 2"];
			lang[27] = ["水浸", "Water", "Eau", "погружение", "Inmersión", "الفيضانات"];
			lang[28] = ["烟雾", "Smoke", "Fumée", "дым", "Humo", "دخان"];
			lang[29] = ["信息", "Information", "Information", "сведения", "Información", "معلومات"];
			lang[30] = ["工作状态：", "Working status:", "Travail état:", "режим работы:", "Estado de trabajo:", "حالة العمل:"];
			lang[31] = ["PDU位置:", "PDU location:", "PDU Position:", "PDU должность:", "Posición PDU:", "Posición PDU:"];
			lang[32] = ["运行时长：", "PDU uptime:", "Temps:", "длительность эксплуатации:", "Duración del funcionamiento:", "وقت التشغيل:"];
			lang[33] = ["产品系列：", "PDU series:", "PDU Série:", "серия продуктов:", "Serie de productos:", "سلسلة المنتج:"];
			lang[34] = ["软件版本：", "PDU version:", "PDU Version:", "версия программного обеспечения:", "Versión de software:", "إصدار البرنامج:"];
			lang[35] = ["实时动态趋势图", "Real-time dynamic trend graph", "Temps réel diagramme dynamique", "диаграмма динамической мощности и тенденций течения в реальном масштабе времени", "Dynamic Power and Electricity Trends in Time time", "في الوقت الحقيقي قوة ديناميكية والرسم البياني الحالي الاتجاه"];
			lang[36] = ["主机", "", "", "", ""];
			lang[37] = ["副机", "", "", "", ""];
			lang[38] = ["开启", "", "", "", ""];
			lang[39] = ["关闭", "", "", "", ""];
			lang[40] = ["正常", "", "", "", ""];
			lang[41] = ["告警", "", "", "", ""];
			lang[42] = ["断开", "", "", "", ""];
			lang[43] = ["闭合", "", "", "", ""];
			dev_name[0] = lang[36][language];
			for (let i = 1; i < (slave_num + 1); i++) {
				dev_name[i] = lang[37][language] + i;
			}
			Sensor_state[1] = lang[38][language];
			Sensor_state[2] = lang[39][language];
			Sensor_state[1] = lang[40][language];
			Sensor_state[2] = lang[41][language];
			stat_[0] = lang[42][language];
			stat_[1] = lang[43][language];
			stat_[2] = "-";
		}
		function LangFun() {
			for (var i = 1; i < 36; i++) {
				if ((i != 6 && i < 29) || i > 34) {
					if(pdu_data.pdu_data.loop_item_list.breaker == undefined && i == 9){
						continue;
					}else{
						document.getElementById("lang_" + i).innerHTML = lang[i][language];
					}

				}
			}
			document.getElementById("ms").value = top.addr_;
			if (slave_num != 0) {
				document.getElementById("dev_sel").style.display = "";
			}
		}
		function ReadChartData() {
			for (let i = 0; i < 3; i++) {
				top.total_data[i] = top.total_data[i].slice(1, sample_num);
				top.inletA_data[i] = top.inletA_data[i].slice(1, sample_num);
				top.inletB_data[i] = top.inletB_data[i].slice(1, sample_num);
				top.inletC_data[i] = top.inletC_data[i].slice(1, sample_num);
			}
			top.total_data[0][49] = parseFloat(total_info[0]).toFixed(2);
			top.total_data[1][49] = 0;
			top.total_data[2][49] = 0;
			if(pdu_data.pdu_info.line_num == 3){
				for (let i = 0; i < 3; i++) {
					top.inletA_data[i][49] = parseFloat(phase_info[0][sample_[i]]).toFixed(2);
					top.inletB_data[i][49] = parseFloat(phase_info[1][sample_[i]]).toFixed(2);			
					top.inletC_data[i][49] = parseFloat(phase_info[2][sample_[i]]).toFixed(2);
				}
			}else{
				for ( i = 0; i < 3; i++) {
					top.inletA_data[i][49] = parseFloat(phase_info[0][sample_[i]]).toFixed(2);
					top.inletB_data[i][49] = parseFloat(phase_info[0][sample_[i]]).toFixed(2);			
					top.inletC_data[i][49] = parseFloat(phase_info[0][sample_[i]]).toFixed(2);
			}
		}
		}
		function ReadData() {
			// system_info[0] = Sys_state[parseInt(sessionStorage.getItem(cfg_name[2] + addr))];
			// system_info[1] = sessionStorage.getItem(uut_name[2] + addr);
			// system_info[2] = sessionStorage.getItem(cfg_name[9] + addr) + " day";
			// system_info[3] = "MPDU(" + serial_[parseInt(sessionStorage.getItem(cfg_name[1] + addr))] + ")";
			// system_info[4] = sessionStorage.getItem(ver_name[1]);
			ShowData();
			ReadChartData();
		}
		function BuildSel(rows) {
			var tbody = '';
			for (var i = 0; i < rows; i++) {
				tbody += '<option id = "opt' + i + '"value ="' + i + '">' + dev_name[i] + '</option>';
			}
			return tbody;
		}
		function ShowData() {
			for(let i = 1;i<= phase_num;i++){
				document.getElementById("L"+i).style.display = "";
			}
			for (let i = 0; i < 4; i++) {
				if (i < 2) {
					document.getElementById('dat' + (i + 1)).innerHTML = parseFloat(total_info[i]).toFixed(2);
				} else if (i == 2) {
					document.getElementById('dat' + (i + 1)).innerHTML = parseFloat(total_info[i]).toFixed(1);
				} else {
					document.getElementById('dat' + (i + 1)).innerHTML = total_info[i];
				}

			}
			for (let i = 0; i < phase_num; i++) {
				document.getElementById('dat' + (72 + i)).innerHTML = parseFloat(phase_info[i][5]).toFixed(3);
				document.getElementById('dat' + (3 * i + 6)).innerHTML = parseFloat(phase_info[i][0]).toFixed(2);
				document.getElementById('dat' + (3 * i + 7)).innerHTML = parseFloat(phase_info[i][1]).toFixed(1);
				document.getElementById('dat' + (3 * i + 8)).innerHTML = parseFloat(phase_info[i][2]).toFixed(2);
				document.getElementById('pgt' + (i + 1)).style.width = parseFloat(phase_info[i][0] / phase_info[i][4]).toFixed(2) * 100 + '%';
				if (phase_info[i][3] == 2 || phase_info[i][3] == 4) {
					document.getElementById('pgt' + (i + 1)).style.background = 'yellow';
				}
				else if (phase_info[i][3] == 1 || phase_info[i][3] == 8) {
					document.getElementById('pgt' + (i + 1)).style.background = 'red';
				}
				else {
					document.getElementById('pgt' + (i + 1)).style.background = '';
				}
				document.getElementById("progress" + (i + 1)).title = parseFloat(phase_info[i][0] / phase_info[i][4]).toFixed(2) * 100 + '%';
			}
			for (let i = 0; i < loop_num; i++) {
				if(pdu_data.pdu_data.loop_item_list.breaker != undefined){
					for (j = 0; j < 8; j++) {
					if (j > 2 && j != 5 && j != 7) {
						if (j == 6) {
							document.getElementById('dat' + (16 + i * 8 + j)).innerHTML = parseFloat(loop_info[i][j]).toFixed(3) + loop_unit[j];
						} else {
							document.getElementById('dat' + (16 + i * 8 + j)).innerHTML = parseFloat(loop_info[i][j]).toFixed(2) + loop_unit[j];
						}
					} else if (j == 5 || j == 7) {
						document.getElementById('dat' + (16 + i * 8 + j)).innerHTML = parseFloat(loop_info[i][j]).toFixed(1) + loop_unit[j];
					} else {
						if (j == 1) {
							document.getElementById('dat' + (16 + i * 8 + j)).innerHTML = stat_[loop_info[i][j]];
						} else {
							document.getElementById('dat' + (16 + i * 8 + j)).innerHTML = loop_info[i][j];
						}
					}
				}					
				}else{
					for (j = 0; j < 7; j++) {
					if (j > 1 && j != 4 && j != 6) {
						if (j == 5) {
							document.getElementById('dat' + (16 + i * 8 + j)).innerHTML = parseFloat(loop_info[i][j]).toFixed(3) + loop_unit[j];
						} else {
							document.getElementById('dat' + (16 + i * 8 + j)).innerHTML = parseFloat(loop_info[i][j]).toFixed(2) + loop_unit[j];
						}
					} else if (j == 4 || j == 6) {
						document.getElementById('dat' + (16 + i * 8 + j)).innerHTML = parseFloat(loop_info[i][j]).toFixed(1) + loop_unit[j];
					} else {
						//if (j == 1) {
					//		document.getElementById('dat' + (16 + i * 8 + j)).innerHTML = stat_[loop_info[i][j]];
					//	} else {
						document.getElementById('dat' + (16 + i * 8 + j)).innerHTML = loop_info[i][j];
					//	}
					}
				}
				}

			}
			for (let i = 0; i < head.length; i++) {
				if (i < 4) {//insert
					if (pdu_data.pdu_data.env_item_list.insert[parseInt(i / 2)]  == 0) {
						if (i % 2 == 0) {
							document.getElementById('dat' + (64 + i)).innerHTML = "NA";
						} else {
							document.getElementById('dat' + (64 + i)).innerHTML = "NA";
						}
					} else {
						if (i % 2 == 0) {
							document.getElementById('dat' + (64 + i)).innerHTML = sensor_info[i] + "°C";
						} else {
							document.getElementById('dat' + (64 + i)).innerHTML = sensor_info[i] + "%";
						}
					}
				} else if (i < 6) {
					document.getElementById('dat' + (64 + i)).innerHTML = Sensor_state[sensor_info[i]];
				} else {
					document.getElementById('dat' + (64 + i)).innerHTML = Sensor_state_[sensor_info[i]];
				}
			}
			for(let i = 0;i < pdu_data.pdu_data.env_item_list.hum_alarm_status.length;i++){
				if(pdu_data.pdu_data.env_item_list.hum_alarm_status[i] == 2 || pdu_data.pdu_data.env_item_list.hum_alarm_status[i] == 4){
					document.getElementById('dat' + (64 + 2*i)).bgColor = 'yellow';
				}else if(pdu_data.pdu_data.env_item_list.hum_alarm_status[i] == 1 || pdu_data.pdu_data.env_item_list.hum_alarm_status[i] == 8){
					document.getElementById('dat' + (64 + 2*i)).bgColor = 'red';
				}else{
					document.getElementById('dat' + (64 + 2*i)).bgColor = '';
				}
				if(pdu_data.pdu_data.env_item_list.tem_alarm_status[i] == 2 || pdu_data.pdu_data.env_item_list.tem_alarm_status[i] == 4){
					document.getElementById('dat' + (65 + 2*i)).bgColor = 'yellow';
				}else if(pdu_data.pdu_data.env_item_list.tem_alarm_status[i] == 1 || pdu_data.pdu_data.env_item_list.tem_alarm_status[i] == 8){
					document.getElementById('dat' + (65 + 2*i)).bgColor = 'red';
				}else{
					document.getElementById('dat' + (65 + 2*i)).bgColor = '';
				}
			}
			for(let i = 0;i < loop_num;i++){
				if(pdu_data.pdu_data.loop_item_list.breaker == undefined){
					break;
				}
				if(pdu_data.pdu_data.loop_item_list.breaker[i] == 0){
					document.getElementById('dat' + (17 + 8*i)).bgColor = 'red';
				}else{
					document.getElementById('dat' + (17 + 8*i)).bgColor = '';
				}
			}
			for(let i = 0;i < phase_num;i++){
				if(pdu_data.pdu_data.line_item_list.vol_alarm_status[i] == 2 || pdu_data.pdu_data.line_item_list.vol_alarm_status[i] == 4){
					document.getElementById('dat' + (7 + 3*i)).style.backgroundColor = 'yellow';
				}else if(pdu_data.pdu_data.line_item_list.vol_alarm_status[i] == 1 || pdu_data.pdu_data.line_item_list.vol_alarm_status[i] == 8){
					document.getElementById('dat' + (7 + 3*i)).style.backgroundColor = 'red';
				}else{
					document.getElementById('dat' + (7 + 3*i)).style.backgroundColor ="";
				}
			}
		}
		function ModeSet(modesel) {
			let ms = document.getElementById("sel");
			let iptname = document.getElementsByTagName("input");
			for (let i = 0; i < iptname.length; i++) {
				iptname[i].disabled = true;
			}
		}
		function BuildTablePhase(obj) {
			let tbody = '';
			if (obj == 0) {
				for (let i = 0; i < 4; i++) {
					if (i < 2) {
						tbody += '<tr><td><span class = "span_tit" style="line-height:40px;font-size:40px;padding-top:15px;" id ="dat' + (i + 1) + '"></span>';
						tbody += '<span class = "span_data" style=" padding-top:28px;">' + total_title[i] + '</span></td></tr>';
					} else {
						tbody += '<tr><td style="padding-top:' + (15 - (i - 2) * 5) + 'px;"><span class = "span_tit" id ="lang_' + (i + 2) + '"></span>';
						tbody += '<span class = "span_data" id ="dat' + (i + 1) + '"></span>';
						tbody += '<span class = "span_unit">' + total_title[i] + '</span></td></tr>';
					}
				}
			} else {
				tbody += '<tr><td><span class = "span_tit" >L' + obj + '</span></td></tr>';
				tbody += '<tr><td><span class = "span_tit" style=" line-height:40px;font-size:40px;" id="dat' + (3 * (obj - 1) + 6) + '" ></span>';
				tbody += '<span class = "span_data" style=" padding-top:28px;">A</span></td></tr>';
				tbody += '<tr><td><div class = "progress" id ="progress' + obj + '"><div class ="child"><p style ="height:13px" class="progress-bar" id="pgt' + obj + '"></p></div></div></td></tr>';
				tbody += '<tr style="height:25px;"><td><span class = "span_tit" >U' + obj + ':</span>';
				tbody += '<span class = "span_data"  id="dat' + (3 * (obj - 1) + 7) + '" ></span>';
				tbody += '<span class = "span_unit">V</span></td></tr>';
				tbody += '<tr style="height:25px;"><td><span class = "span_tit" >P' + obj + ':</span>';
				tbody += '<span class = "span_data"  id="dat' + (71 + obj) + '" ></span>';
				tbody += '<span class = "span_unit">kW</span></td></tr>';
				tbody += '<tr style="height:25px;"><td><span class = "span_tit" >PF' + obj + ':</span>';
				tbody += '<span class = "span_data"  id="dat' + (3 * (obj - 1) + 8) + '" ></span>';
				tbody += '<span class = "span_unit"></span></td></tr>';
			}
			return tbody;
		}
		function BuildTableLoop(obj) {
			let tbody = '';
			if(pdu_data.pdu_data.loop_item_list.breaker != undefined){
				tbody += '<tr><td colspan="10" style="text-align:left; padding-left:20px;  height:40px; border-bottom:#e1dfdf 2px solid;" id="lang_7"></td></tr>';
				tbody += '<tr><td class="spacing" id="lang_8"></td>';
				tbody += '<td class="spacing" id="lang_9"></td>';
				tbody += '<td class="spacing" id="lang_10"></td>';
				tbody += '<td class="spacing" id="lang_11"></td>';
				tbody += '<td class="spacing" id="lang_12"></td>';
				tbody += '<td class="spacing" id="lang_13"></td>';
				tbody += '<td class="spacing" id="lang_14"></td>';
				tbody += '<td class="spacing" id="lang_15"></td></tr>';			
			}else{
				tbody += '<tr><td colspan="10" style="text-align:left; padding-left:20px;  height:40px; border-bottom:#e1dfdf 2px solid;" id="lang_7"></td></tr>';
				tbody += '<tr><td class="spacing" id="lang_8"></td>';
				//tbody += '<td class="spacing" id="lang_9"></td>';
				tbody += '<td class="spacing" id="lang_10"></td>';
				tbody += '<td class="spacing" id="lang_11"></td>';
				tbody += '<td class="spacing" id="lang_12"></td>';
				tbody += '<td class="spacing" id="lang_13"></td>';
				tbody += '<td class="spacing" id="lang_14"></td>';
				tbody += '<td class="spacing" id="lang_15"></td></tr>';
			}
				for (let i = 0; i < obj; i++) {
					if (i % 2 == 0) {
						tbody += '<tr id = "tr' + i + '" style="background:#e7e7e7;">';
					} else {
						tbody += '<tr id = "tr' + i + '">';
					}
					for (let j = 0; j < 8; j++) {
						tbody += '<td class="spacing" id="dat' + (16 + i * 8 + j) + '"></td>';
					}
					tbody += '</tr>';
				}
				return tbody;
			
			
		}
		function BuildTableSensor() {
			let tbody = "";
			tbody += '<tr><td width="20%" class="spacing" id="lang_17"></td>';
			tbody += '<td width="30%" class="spacing" id="lang_18"></td>';
			tbody += '<td width="20%" class="spacing" id="lang_19"></td>';
			tbody += '<td width="30%" class="spacing" id="lang_20"></td></tr>';
			for (let i = 0; i < 4; i++) {
				if (i % 2 == 0) {
					tbody += '<tr style="background:#e7e7e7;">';
				} else {
					tbody += '<tr>';
				}
				for (let j = 0; j < 4; j++) {
					if (j % 2 == 0) {
						tbody += '<td class="spacing" id="lang_' + (21 + i * 2 + parseInt(j / 2)) + '"></td>';
					} else {
						tbody += '<td class="spacing" id="dat' + (64 + i * 2 + parseInt(j / 2)) + '"></td>';
					}
				}
				tbody += '</tr>';
			}
			return tbody;
		}
		function BuildTableSystem() {
			let tbody = "";
			for (let i = 0; i < 5; i++) {
				if (i == 0) {
					tbody += '<tr><td class="spacing" style="width:32%" id="lang_' + (30 + i) + '"></td><td id="dat' + (72 + i) + '" style="font-weight:bold"></td></tr>';
				} else {
					tbody += '<tr><td class="spacing" style="width:32%" id="lang_' + (30 + i) + '"></td><td id="dat' + (72 + i) + '"></td></tr>';
				}
			}
			return tbody;
		}
		setInterval(function () {
			ParseData();
			ReadData();
		}, 2000);
	</script>
</body>

</html>