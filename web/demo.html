<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<style type="text/css">
			.selectBox{
				width: 300px;
				height: 36px;
				line-height: 36px;
				background: #f72323;
			}
			.inputCase{
				position: relative;
				width: 100%;
				height: 100%;
				box-sizing: border-box;
			}
			.inputCase input.imitationSelect{
				width: 100%;
				height: 100%;
				box-sizing: border-box;
				border: 1px solid #ccc;
				display: block;
				text-indent: 20px;
				cursor: default;
			}
			.inputCase i.fa{
				position: absolute;
				right: 10px;
				top: 10px;
				color: #007AFF;
			}
			.selectUl{
				display: none;
				padding: 0;
				margin: 0;
				border-bottom: 1px solid #ccc;
				border-left: 1px solid #ccc;
				border-right: 1px solid #ccc;
                max-height: 150px;
                overflow-y: auto;
			}
			.selectUl li{
				height: 36px;
				line-height: 36px;
				list-style: none;
				text-indent: 20px;
				border-bottom: 1px solid #ccc;transition: all .5s ease 0s;

			}
			.selectUl li:hover{
				background: #ddd;
			}
			.selectUl li:last-child{
				border-bottom: 0 none;
			}
		</style>
		<!-- <link rel="stylesheet" type="text/css" href="http://www.jq22.com/jquery/font-awesome.4.6.0.css"> -->
	</head>
	<script src="./include/js/timezone.js"></script>
	<body>
        <div class="selectBox">
        	<div class="inputCase">
				<input class="imitationSelect" type="text" id="TimeZone" >
				<i class="fa fa-caret-down"></i>
			</div>
			<ul class="selectUl">
			</ul>
        </div>
		<script src="https://libs.cdnjs.net/jquery/3.5.1/jquery.min.js"></script>
        <script type="text/javascript">
			$(function(){
				$(".selectBox .imitationSelect").on("click",function(){
					$(this).parent().next().toggle();//ul弹窗展开
					
					$(this).select();
					if (this.value == "") {
						this.value = ntp_data[4];
					} else {
						for (let i = 0; i < timezone_arr.length; i++) {
							if (document.getElementById("TimeZone").value == timezone_arr[i] && document.getElementById("TimeZone").value != ntp_data[4]) {
							 console.log("choose")
								// SetData(this);
							}
						}
					}$(this).next().toggleClass("fa-caret-up")//点击input选择适合，小图标动态切换
					if (event.stopPropagation) {   
			        	// 针对 Mozilla 和 Opera   
			        	event.stopPropagation();   
			        }else if (window.event) {   
			        	// 针对 IE   
			        	window.event.cancelBubble = true;   
			        }   /*阻止事件传播，事件从点击的元素出发，向外（window）传播，
						如果不写个阻止事件，会导致下面的document点击函数一起执行，导致显示失败*/
						
				});
				$(".selectUl li").click(function(event){
					$(this).addClass("actived_li").siblings().removeClass("actived_li");//点击当前的添加。actived_li这个类；其他的移除这个类名
					var data_val = $(this).data("val");//定义一个data-val属性，获取点击的元素属性赋值到当前，方便动态化传值
					var data_id = $(this).data("id");//定义一个id属性，获取点击的元素属性赋值到当前，方便动态化传值
					$(this).parent().prev().children().val(data_val); //把当前点击的name赋值到显示的input的val里面
					$(this).parent().prev().children().data("val",data_val);//把当前点击的data-val赋值到显示的input的data-val里面
                    $(this).parent().prev().children().data("id",data_id);//把当前点击的data-id赋值到显示的input的data-id里面
        
				});
				$(document).click(function(event){
					$(".inputCase .fa").removeClass("fa-caret-up").addClass("fa-caret-down")//当点隐藏ul弹窗时候，把小图标恢复原状
                    $(".selectUl").hide();//当点击空白处，隐藏ul弹窗
                    $(".selectUl li").show()
					if (document.getElementById("TimeZone").value != ntp_data[4]) {
						SetData(document.getElementById("TimeZone"));
					}
                    // $(".selectBox .imitationSelect").val('');
				});
                $(".selectBox .imitationSelect").bind("input propertychange",()=>{
                    $(".selectUl li").hide()
                    let contain=$(".selectBox .imitationSelect").val();
                    // console.log($(this))
                    $(".selectUl li").filter(":contains('"+contain+"')").show()
                    
                })
                
			})
			let ntp_data=new Array(0,0,0,4,0,0)
			$('.selectUl').html(BuildTable());
			function BuildTable(){
				var tbody ="";
				for (var i = 0; i < timezone_arr.length; i++) {
					if (i == 0) {
						tbody += '<li data-val="' + timezone_arr[i] + '" data-id="' + (i + 1) + '" class="actived_li">' + timezone_arr[i] + '</li>';
					} else {
						tbody += '<li data-val="' + timezone_arr[i] + '"  data-id="' + (i + 1) + '">' + timezone_arr[i] + '</li>';
					}
				}
				return tbody;
			}
			//用$(this)来代指当前的操作对象，这样可以减少误差
		</script>
	</body>
</html>
